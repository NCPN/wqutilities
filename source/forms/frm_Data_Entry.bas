Version =20
VersionRequired =20
Checksum =-948430236
Begin Form
    AllowFilters = NotDefault
    PopUp = NotDefault
    Modal = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularFamily =0
    BorderStyle =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =12960
    DatasheetFontHeight =10
    ItemSuffix =43
    Left =5400
    Top =2085
    Right =20145
    Bottom =11610
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x9732d2b75782e340
    End
    OnDirty ="[Event Procedure]"
    RecordSource ="SELECT tbl_Locations.Site_ID, tbl_Locations.Park_code, tbl_Locations.Location_ty"
        "pe, tbl_Events.*, tbl_Locations.Travel_notes FROM tbl_Locations INNER JOIN tbl_E"
        "vents ON tbl_Locations.Location_ID = tbl_Events.Location_ID;"
    Caption =" Main Project Data Entry Form"
    OnCurrent ="[Event Procedure]"
    BeforeUpdate ="[Event Procedure]"
    AfterUpdate ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x00000000403e1d00f4995c016fa0de55309a5c0140985c01a0985c0102000000 ,
        0x010400069c004c2053ff000201000100ea0a6f08640001000f00580201000100 ,
        0x5802030001004c657474657200000000c0441d0000000000c0441d00ed5cde55 ,
        0xa0985c01785d0000000000000000000000000000010000000000000001000000 ,
        0x0200000029010000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200280a640ce813159f23d70000000000000000000000000000000000000000 ,
        0x00000000000000004f0000000000000000000000000000000000000000000000 ,
        0x0000000001000000010000000000000000000000000000000000000000000000 ,
        0x0500030004000300040004000400000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000001000100010001000100010001000100000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000000000000000000280a0000534d544a ,
        0x000000001000180a48005000200043006f006c006f00720020004c0061007300 ,
        0x650072004a006500740020004300500034003000320030002000530065007200 ,
        0x6900650073002000500043004c0036000000496e70757442696e00464f524d53 ,
        0x4f5552434500524553444c4c00556e69726573444c4c004850446f6355495355 ,
        0x49005472756500455350524954537570706f727465640054727565005265736f ,
        0x6c7574696f6e0036303064706900466173745265730046616c73650048505068 ,
        0x79736963616c4f7269656e746174696f6e00504f5f506f727472616974004f72 ,
        0x69656e746174696f6e00504f5254524149540048504f7269656e74526f746174 ,
        0x653138300046616c7365004475706c6578004e4f4e4500506170657253697a65 ,
        0x004c4554544552004d6564696154797065004155544f00436f6c6c617465004f ,
        0x4e0048504d65646961547970655472656576696577506f707570005472756500 ,
        0x436f6c6f724d6f646500323462707000546578744173426c61636b0046616c73 ,
        0x6500545441734269746d61707353657474696e670054544d6f64654f75746c69 ,
        0x6e65004a504547456e61626c65004175746f00416c7465726e6174654c657474 ,
        0x6572486561640046616c7365004850506170657253697a65414c4d436f6e7374 ,
        0x7261696e74730053544154454d454e540048504561726c795761726d5570436f ,
        0x6d6d616e6400456e61626c65004850437573746f6d4455706c657861626c6552 ,
        0x616e676500332e383778352e38335f382e35783134005468726573686f6c644d ,
        0x6f706965724844003238384d42005072696e745175616c69747947726f757000 ,
        0x505147726f75705f31004850446f6350726f705265736f757263654461746100 ,
        0x687063686c3039312e636162004850436f6c6f72536d617274004175746f6d61 ,
        0x746963004850436f6c6f72536d6172745f436f6c6f724f7074696f6e735f4564 ,
        0x6765436f6e74726f6c004e6f726d616c004850436f6c6f72536d6172745f5465 ,
        0x78745f4e65757472616c477261797300426c61636b4f6e6c79004850436f6c6f ,
        0x72536d6172745f546578745f48616c66746f6e650044657461696c004850436f ,
        0x6c6f72536d6172745f47726170686963735f4e65757472616c47726179730042 ,
        0x6c61636b4f6e6c79004850436f6c6f72536d6172745f47726170686963735f48 ,
        0x616c66746f6e650044657461696c004850436f6c6f72536d6172745f50686f74 ,
        0x6f5f4e65757472616c477261797300342d436f6c6f72004850436f6c6f72536d ,
        0x6172745f50686f746f5f48616c66746f6e650044657461696c004850436f6c6f ,
        0x724d6f646500434f4c4f525f4d4f444500485050444c547970650050444c5f50 ,
        0x434c36004850504a4c456e636f64696e6700555446380048504a6f624163636f ,
        0x756e74696e670048504a4f42414343545f4a4f4241434e545f434f4c4f524155 ,
        0x54480048504a6f6242794a6f624f76657272696465004a424a4f0048504a6f62 ,
        0x416363576f50696e0054727565004850584d4c46696c65557365640068706334 ,
        0x353230362e786d6c0048504d616e75616c4475706c65784469616c6f67497465 ,
        0x6d7300496e737472756374696f6e49445f30315f46414345444f574e2d4e4f52 ,
        0x4f54415445004850506170657253697a654475706c6578436f6e73747261696e ,
        0x74730053544154454d454e540048504d65646961547970654475706c6578436f ,
        0x6e73747261696e7473005452414e53504152454e435900485050434c36506173 ,
        0x735468726f7567680054727565004850536d6172744475706c657853696e676c ,
        0x65506167654a6f620054727565004850536d6172744475706c65784f64645061 ,
        0x67654a6f6200547275650048504d616e75616c466565644f7269656e74617469 ,
        0x6f6e004641434555500048504f757470757442696e4f7269656e746174696f6e ,
        0x0046414345444f574e0048504d616e75616c4475706c65784469616c6f674d6f ,
        0x64656c004d6f64656c6573730048504d61704d616e75616c46656564546f5472 ,
        0x61793100547275650048504d616e75616c4475706c657850616765526f746174 ,
        0x6500447269766572526f746174650048505072696e744f6e426f746853696465 ,
        0x734d616e75616c6c790046616c73650048505072696e74496e47726179536361 ,
        0x6c650046616c73650048504e5573654469666646697273745061676543686f69 ,
        0x6365005452554500485050616765457863657074696f6e7346696c6500485043 ,
        0x504530393100485050616765457863657074696f6e73496e7465726661636500 ,
        0x53686f7750616765457863657074696f6e730048505061676545786365707469 ,
        0x6f6e7300436f766572496e73657274696f6e0048504475706c69636174654a6f ,
        0x624e616d654f766572726964650053574657004850506e67506173737468726f ,
        0x7567680054727565005053416c69676e6d656e7446696c65004850434c533039 ,
        0x31004850536d6172744875625f4f6e6c696e65646961676e6f73746963746f6f ,
        0x6c730054525545004850536d6172744875625f537570706f7274616e6474726f ,
        0x75626c6573686f6f74696e670054525545004850536d6172744875625f50726f ,
        0x647563746d616e75616c730054525545004850536d6172744875625f43686563 ,
        0x6b666f72647269766572757064617465730054525545004850536d6172744875 ,
        0x625f436f6c6f727072696e74696e676163636573737573616765005452554500 ,
        0x4850536d6172744875625f4f72646572737570706c6965730054525545005053 ,
        0x53657276696365735f5072696e74636f6c6f7275736167656a6f626c6f670054 ,
        0x52554500505353657276696365735f446576696365616e64537570706c696573 ,
        0x537461747573005452554500505353657276696365734f7074696f6e00505353 ,
        0x6572766963657344756d6d794f7074696f6e004850536d61727448756200496e ,
        0x65745f5349445f3236335f4249445f3531345f4849445f323635004850436f6e ,
        0x73756d6572437573746f6d50617065720054727565004850456e61626c655241 ,
        0x5753706f6f6c696e67005472756500524742436f6c6f720044656661756c742d ,
        0x73524742004a52436f6e73747261696e7473004a524348445061727469616c00 ,
        0x4a524844496e7374616c6c6564004a5248444f6666004a5248444e6f74496e73 ,
        0x74616c6c6564004a5248444f666600485042657374476c6f7373004445464155 ,
        0x4c5400485045617379436f6c6f72004f6e0048504d48444c4c4e616d65004850 ,
        0x4649453039310000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0xe81300004955504817000100789ced99416b13411886df4d404a555ae8c18397 ,
        0x5c14bd04841cd48ab2d96cdad0c6ae5dc182f550d38d14d246d216f4660f22fe ,
        0x057f82fd13397a15bc8a474b7f8178b0beb34964b3edb41e826bc9fb0cdfcecc ,
        0x37333b43e6db6f3233073340c50fe6afc08121d7975eae473e917618d6e367fe ,
        0x4f3d132f22c20e43840e6c38389c6c4f0047094cfb0bd6167f8f938a6dfc629f ,
        0x053cc516da9408cf46d0b7385f68fec71b973e6a036b68653d109109254ad04f ,
        0x0fd68b6eb73b142771fab27eace4cd83b3fa4aaf47392af2cef07a95ae53c612 ,
        0x1e32d4e0c3a3b5d639da32d38b0c621cb8c759dfe5bfa93636e9a776e8ad1ab8 ,
        0x9ff5a0c43fc6b148ba2cdd66289d3bfd9d49fd14e5665f994c2719e86de5a589 ,
        0x9e0831e0b2b197b336664288b1c3b68e08214687f9c4aadc4b34e25d4507af51 ,
        0x4005119ad4eda245ed76d64314ff11e6acc3d84c3dde7b766833db9426eda4c0 ,
        0xbd698321a246362384c896234a71ca5efe998e6cf292bdfc3be5e7457bb93942 ,
        0x317795f5d0f53c3f0c8bfe8a6ff4b6f399514afabce5b4f3971bc97c0ed38331 ,
        0x7ab88b5504b1177fc1e71a36e9c5abf4ecadd88baf9ee8e5971837637dc41ac9 ,
        0xdc2d94e2362157028fc1672a4491f10a7cfbcf2832e7797cebb9c5798c3893c6 ,
        0x0e5e5217d10e741726c4b8a00317d1a316b85e65f949259c731f7b6e50bb3abb ,
        0x5f7d573af0f7be7cbb3df36876e158838d0f5fdf5effe1bfbf7678e7e3f4ab4f ,
        0x41509e77fde5e084570b2184104208218410e21cf11b406174c4000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000
    End
    PrtDevNames = Begin
        0x08002d0066000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000048504449555f31302e3134382e38332e353800
    End
    OnUndo ="[Event Procedure]"
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    FilterOnLoad =0
    AllowLayoutView =0
    DatasheetGridlinesColor12 =12632256
    PrtDevModeW = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x430050004e00200048005000200043006f006c006f00720020004c0000000000 ,
        0x01040006dc004c2053ff000201000100ea0a6f08640001000f00580201000100 ,
        0x5802030001004c00650074007400650072000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000029010000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200280a640ce813159f23d70000000000000000000000000000000000000000 ,
        0x00000000000000004f0000000000000000000000000000000000000000000000 ,
        0x0000000001000000010000000000000000000000000000000000000000000000 ,
        0x0500030004000300040004000400000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000001000100010001000100010001000100000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000000000000000000280a0000534d544a ,
        0x000000001000180a48005000200043006f006c006f00720020004c0061007300 ,
        0x650072004a006500740020004300500034003000320030002000530065007200 ,
        0x6900650073002000500043004c0036000000496e70757442696e00464f524d53 ,
        0x4f5552434500524553444c4c00556e69726573444c4c004850446f6355495355 ,
        0x49005472756500455350524954537570706f727465640054727565005265736f ,
        0x6c7574696f6e0036303064706900466173745265730046616c73650048505068 ,
        0x79736963616c4f7269656e746174696f6e00504f5f506f727472616974004f72 ,
        0x69656e746174696f6e00504f5254524149540048504f7269656e74526f746174 ,
        0x653138300046616c7365004475706c6578004e4f4e4500506170657253697a65 ,
        0x004c4554544552004d6564696154797065004155544f00436f6c6c617465004f ,
        0x4e0048504d65646961547970655472656576696577506f707570005472756500 ,
        0x436f6c6f724d6f646500323462707000546578744173426c61636b0046616c73 ,
        0x6500545441734269746d61707353657474696e670054544d6f64654f75746c69 ,
        0x6e65004a504547456e61626c65004175746f00416c7465726e6174654c657474 ,
        0x6572486561640046616c7365004850506170657253697a65414c4d436f6e7374 ,
        0x7261696e74730053544154454d454e540048504561726c795761726d5570436f ,
        0x6d6d616e6400456e61626c65004850437573746f6d4455706c657861626c6552 ,
        0x616e676500332e383778352e38335f382e35783134005468726573686f6c644d ,
        0x6f706965724844003238384d42005072696e745175616c69747947726f757000 ,
        0x505147726f75705f31004850446f6350726f705265736f757263654461746100 ,
        0x687063686c3039312e636162004850436f6c6f72536d617274004175746f6d61 ,
        0x746963004850436f6c6f72536d6172745f436f6c6f724f7074696f6e735f4564 ,
        0x6765436f6e74726f6c004e6f726d616c004850436f6c6f72536d6172745f5465 ,
        0x78745f4e65757472616c477261797300426c61636b4f6e6c79004850436f6c6f ,
        0x72536d6172745f546578745f48616c66746f6e650044657461696c004850436f ,
        0x6c6f72536d6172745f47726170686963735f4e65757472616c47726179730042 ,
        0x6c61636b4f6e6c79004850436f6c6f72536d6172745f47726170686963735f48 ,
        0x616c66746f6e650044657461696c004850436f6c6f72536d6172745f50686f74 ,
        0x6f5f4e65757472616c477261797300342d436f6c6f72004850436f6c6f72536d ,
        0x6172745f50686f746f5f48616c66746f6e650044657461696c004850436f6c6f ,
        0x724d6f646500434f4c4f525f4d4f444500485050444c547970650050444c5f50 ,
        0x434c36004850504a4c456e636f64696e6700555446380048504a6f624163636f ,
        0x756e74696e670048504a4f42414343545f4a4f4241434e545f434f4c4f524155 ,
        0x54480048504a6f6242794a6f624f76657272696465004a424a4f0048504a6f62 ,
        0x416363576f50696e0054727565004850584d4c46696c65557365640068706334 ,
        0x353230362e786d6c0048504d616e75616c4475706c65784469616c6f67497465 ,
        0x6d7300496e737472756374696f6e49445f30315f46414345444f574e2d4e4f52 ,
        0x4f54415445004850506170657253697a654475706c6578436f6e73747261696e ,
        0x74730053544154454d454e540048504d65646961547970654475706c6578436f ,
        0x6e73747261696e7473005452414e53504152454e435900485050434c36506173 ,
        0x735468726f7567680054727565004850536d6172744475706c657853696e676c ,
        0x65506167654a6f620054727565004850536d6172744475706c65784f64645061 ,
        0x67654a6f6200547275650048504d616e75616c466565644f7269656e74617469 ,
        0x6f6e004641434555500048504f757470757442696e4f7269656e746174696f6e ,
        0x0046414345444f574e0048504d616e75616c4475706c65784469616c6f674d6f ,
        0x64656c004d6f64656c6573730048504d61704d616e75616c46656564546f5472 ,
        0x61793100547275650048504d616e75616c4475706c657850616765526f746174 ,
        0x6500447269766572526f746174650048505072696e744f6e426f746853696465 ,
        0x734d616e75616c6c790046616c73650048505072696e74496e47726179536361 ,
        0x6c650046616c73650048504e5573654469666646697273745061676543686f69 ,
        0x6365005452554500485050616765457863657074696f6e7346696c6500485043 ,
        0x504530393100485050616765457863657074696f6e73496e7465726661636500 ,
        0x53686f7750616765457863657074696f6e730048505061676545786365707469 ,
        0x6f6e7300436f766572496e73657274696f6e0048504475706c69636174654a6f ,
        0x624e616d654f766572726964650053574657004850506e67506173737468726f ,
        0x7567680054727565005053416c69676e6d656e7446696c65004850434c533039 ,
        0x31004850536d6172744875625f4f6e6c696e65646961676e6f73746963746f6f ,
        0x6c730054525545004850536d6172744875625f537570706f7274616e6474726f ,
        0x75626c6573686f6f74696e670054525545004850536d6172744875625f50726f ,
        0x647563746d616e75616c730054525545004850536d6172744875625f43686563 ,
        0x6b666f72647269766572757064617465730054525545004850536d6172744875 ,
        0x625f436f6c6f727072696e74696e676163636573737573616765005452554500 ,
        0x4850536d6172744875625f4f72646572737570706c6965730054525545005053 ,
        0x53657276696365735f5072696e74636f6c6f7275736167656a6f626c6f670054 ,
        0x52554500505353657276696365735f446576696365616e64537570706c696573 ,
        0x537461747573005452554500505353657276696365734f7074696f6e00505353 ,
        0x6572766963657344756d6d794f7074696f6e004850536d61727448756200496e ,
        0x65745f5349445f3236335f4249445f3531345f4849445f323635004850436f6e ,
        0x73756d6572437573746f6d50617065720054727565004850456e61626c655241 ,
        0x5753706f6f6c696e67005472756500524742436f6c6f720044656661756c742d ,
        0x73524742004a52436f6e73747261696e7473004a524348445061727469616c00 ,
        0x4a524844496e7374616c6c6564004a5248444f6666004a5248444e6f74496e73 ,
        0x74616c6c6564004a5248444f666600485042657374476c6f7373004445464155 ,
        0x4c5400485045617379436f6c6f72004f6e0048504d48444c4c4e616d65004850 ,
        0x4649453039310000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0xe81300004955504817000100789ced99416b13411886df4d404a555ae8c18397 ,
        0x5c14bd04841cd48ab2d96cdad0c6ae5dc182f550d38d14d246d216f4660f22fe ,
        0x057f82fd13397a15bc8a474b7f8178b0beb34964b3edb41e826bc9fb0cdfcecc ,
        0x37333b43e6db6f3233073340c50fe6afc08121d7975eae473e917618d6e367fe ,
        0x4f3d132f22c20e43840e6c38389c6c4f0047094cfb0bd6167f8f938a6dfc629f ,
        0x053cc516da9408cf46d0b7385f68fec71b973e6a036b68653d109109254ad04f ,
        0x0fd68b6eb73b142771fab27eace4cd83b3fa4aaf47392af2cef07a95ae53c612 ,
        0x1e32d4e0c3a3b5d639da32d38b0c621cb8c759dfe5bfa93636e9a776e8ad1ab8 ,
        0x9ff5a0c43fc6b148ba2cdd66289d3bfd9d49fd14e5665f994c2719e86de5a589 ,
        0x9e0831e0b2b197b336664288b1c3b68e08214687f9c4aadc4b34e25d4507af51 ,
        0x4005119ad4eda245ed76d64314ff11e6acc3d84c3dde7b766833db9426eda4c0 ,
        0xbd698321a246362384c896234a71ca5efe998e6cf292bdfc3be5e7457bb93942 ,
        0x317795f5d0f53c3f0c8bfe8a6ff4b6f399514afabce5b4f3971bc97c0ed38331 ,
        0x7ab88b5504b1177fc1e71a36e9c5abf4ecadd88baf9ee8e5971837637dc41ac9 ,
        0xdc2d94e2362157028fc1672a4491f10a7cfbcf2832e7797cebb9c5798c3893c6 ,
        0x0e5e5217d10e741726c4b8a00317d1a316b85e65f949259c731f7b6e50bb3abb ,
        0x5f7d573af0f7be7cbb3df36876e158838d0f5fdf5effe1bfbf7678e7e3f4ab4f ,
        0x41509e77fde5e084570b2184104208218410e21cf11b406174c4000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000
    End
    PrtDevNamesW = Begin
        0x0400290062000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000480050004400490055005f00310030002e003100340038002e003800 ,
        0x33002e00350038000000
    End
    NoSaveCTIWhenDisabled =1
    Begin
        Begin Label
            BackStyle =0
            BackColor =-2147483633
            ForeColor =-2147483630
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            PictureAlignment =2
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
            BorderLineStyle =0
        End
        Begin OptionButton
            SpecialEffect =2
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
        End
        Begin CheckBox
            SpecialEffect =2
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
        End
        Begin BoundObjectFrame
            SpecialEffect =2
            OldBorderStyle =0
            BorderLineStyle =0
            BackStyle =0
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            BorderLineStyle =0
            BackColor =-2147483643
            ForeColor =-2147483640
            AsianLineBreak =255
        End
        Begin ListBox
            SpecialEffect =2
            BorderLineStyle =0
            BackColor =-2147483643
            ForeColor =-2147483640
        End
        Begin ComboBox
            SpecialEffect =2
            BorderLineStyle =0
            BackColor =-2147483643
            ForeColor =-2147483640
        End
        Begin Subform
            SpecialEffect =2
            BorderLineStyle =0
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
        End
        Begin ToggleButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
            BorderLineStyle =0
        End
        Begin Tab
            BackStyle =0
            BorderLineStyle =0
        End
        Begin FormHeader
            Height =0
            BackColor =13692912
            Name ="FormHeader"
            GUID = Begin
                0x51e9357498d9be45b6a3e00cde2b6e72
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =9015
            BackColor =13692912
            Name ="Detail"
            GUID = Begin
                0x6c56edf1093efd4a9fd27eae0c0ebff8
            End
            Begin
                Begin TextBox
                    Locked = NotDefault
                    AllowAutoCorrect = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =4080
                    Top =120
                    Width =960
                    Height =252
                    TabIndex =2
                    Name ="txtDate"
                    Format ="Short Date"
                    BeforeUpdate ="[Event Procedure]"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Arial"
                    OnGotFocus ="[Event Procedure]"
                    GUID = Begin
                        0xc1275b3c1bf15b45ac21d5f6d819fc2e
                    End
                    ShowDatePicker =0

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =3480
                            Top =120
                            Width =480
                            Height =252
                            FontWeight =700
                            Name ="labDate"
                            Caption ="Date"
                            FontName ="Arial"
                            GUID = Begin
                                0xf447d539e34f924682c5fa2ae2f49f35
                            End
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    Locked = NotDefault
                    AllowAutoCorrect = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =3
                    ListWidth =2160
                    Left =2520
                    Top =120
                    Width =900
                    Height =252
                    TabIndex =1
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"20\""
                    GUID = Begin
                        0xca18e40caf65fe449a89c6fea033ae86
                    End
                    Name ="cmbSite"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tbl_Locations.Location_ID, tbl_Sites.Site_code, tbl_Sites.Site_status FRO"
                        "M tbl_Sites INNER JOIN tbl_Locations ON tbl_Sites.Site_ID = tbl_Locations.Site_I"
                        "D WHERE (((tbl_Sites.Park_code)=[Forms]![frm_Data_Entry]![cmbPark]) AND ((tbl_Lo"
                        "cations.Location_type)=\"origin\")) ORDER BY tbl_Sites.Site_status, tbl_Sites.Si"
                        "te_code;"
                    ColumnWidths ="0;720;1440"
                    StatusBarText ="Site membership of the sample location (transect)"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Arial"
                    OnKeyDown ="[Event Procedure]"
                    OnGotFocus ="[Event Procedure]"
                    OnNotInList ="[Event Procedure]"
                    BaseInfo ="\"SELECT tbl_Locations.Location_ID, tbl_Sites.Site_code, tbl_Sites.Site_status F"
                        "ROM tbl_Sites INNER JOIN tbl_Locations ON tbl_Sites.Site_ID = tbl_Locations.Site"
                        "_ID WHERE (((tbl_Sites.Park_code)=[Forms]![frm_Data_Entry]![cmbPark]) AND ((tbl_"
                        "Locations.Location_type)=\"\"origin\"\")) ORDER BY tbl_Sites.Site_status, tbl_Si"
                        "tes.Site_code;\";\"tbl_Sites\";\"tbl_Locations\";\"\""

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =1560
                            Top =120
                            Width =837
                            Height =252
                            FontWeight =700
                            Name ="labSite_code"
                            Caption ="Transect"
                            FontName ="Arial"
                            GUID = Begin
                                0x6d63a44b2eeddf42beae769b856582eb
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =11820
                    Top =780
                    Width =1020
                    Height =300
                    FontWeight =700
                    TabIndex =5
                    Name ="cmdNew"
                    Caption ="Next site"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ControlTipText ="Move to a new record"
                    GUID = Begin
                        0xf016ca2c791d8f4f9de7eb01c3d7eab5
                    End

                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =12180
                    Top =120
                    Width =660
                    Height =300
                    FontWeight =700
                    TabIndex =8
                    Name ="cmdClose"
                    Caption ="Close"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ControlTipText ="Close the form"
                    GUID = Begin
                        0x5c238cd9690c7c44b322d531163bf765
                    End

                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5580
                    Top =420
                    Width =540
                    Height =299
                    FontWeight =700
                    TabIndex =7
                    Name ="cmdNewUser"
                    Caption ="New"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ControlTipText ="Add a new contact name"
                    GUID = Begin
                        0x08195aab9617004b86209526e96907d2
                    End

                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                Begin Subform
                    OverlapFlags =85
                    Left =6180
                    Top =120
                    Width =5514
                    Height =1080
                    TabIndex =3
                    Name ="subObservers"
                    SourceObject ="Form.fsub_Observers"
                    LinkChildFields ="Event_ID;Observer_role"
                    LinkMasterFields ="Event_ID;txtObserverRole"
                    GUID = Begin
                        0xe31065c91b40314591ead044363249db
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =5100
                            Top =120
                            Width =957
                            Height =252
                            FontWeight =700
                            Name ="labObservers"
                            Caption ="Observers"
                            FontName ="Arial"
                            GUID = Begin
                                0x92604074367322479d8b0fc75415aba1
                            End
                        End
                    End
                End
                Begin Tab
                    OverlapFlags =85
                    Top =1320
                    Width =12960
                    Height =7695
                    TabIndex =4
                    Name ="pgTabs"
                    GUID = Begin
                        0x3349c7e7c514c449b020d2adc723fdcd
                    End

                    Begin
                        Begin Page
                            OverlapFlags =87
                            Top =1725
                            Width =12825
                            Height =7155
                            Name ="pgTransectVisitLog"
                            Caption =" Transect visit log"
                            GUID = Begin
                                0x75a28d2650fb9843809e3a0e6e70d79c
                            End
                            LayoutCachedTop =1725
                            LayoutCachedWidth =12825
                            LayoutCachedHeight =8880
                            WebImagePaddingLeft =2
                            WebImagePaddingTop =2
                            WebImagePaddingRight =2
                            WebImagePaddingBottom =2
                            Begin
                                Begin Subform
                                    OverlapFlags =247
                                    Left =188
                                    Top =1736
                                    Width =12348
                                    Height =3108
                                    Name ="subTransectVisitEvents"
                                    SourceObject ="Form.fsub_Transect_Visit_Events"
                                    LinkChildFields ="Start_date"
                                    LinkMasterFields ="txtDate"
                                    OnExit ="[Event Procedure]"
                                    GUID = Begin
                                        0x7cf7dd03bafc344b9eafc48f95f3a19d
                                    End

                                End
                                Begin TextBox
                                    EnterKeyBehavior = NotDefault
                                    AllowAutoCorrect = NotDefault
                                    ScrollBars =2
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =1920
                                    Top =4920
                                    Width =9840
                                    Height =779
                                    TabIndex =1
                                    Name ="txtTravel_notes"
                                    ControlSource ="Travel_notes"
                                    StatusBarText ="Travel description for reaching and relocating this sample location"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0x0ea5546c16215b4ab6bdbf321d550a4c
                                    End

                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            TextAlign =3
                                            Top =4920
                                            Width =1800
                                            Height =435
                                            FontWeight =700
                                            Name ="labTravel_notes"
                                            Caption ="Multi-year travel logistics description"
                                            FontName ="Arial"
                                            GUID = Begin
                                                0x9e5521adc7676a4babcebe5ccdb0000e
                                            End
                                        End
                                    End
                                End
                                Begin TextBox
                                    EnterKeyBehavior = NotDefault
                                    AllowAutoCorrect = NotDefault
                                    ScrollBars =2
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =1920
                                    Top =5760
                                    Width =9840
                                    Height =900
                                    TabIndex =2
                                    Name ="txtEvent_notes"
                                    ControlSource ="Event_notes"
                                    StatusBarText ="Comments about the sampling event, including logistics notes"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0x80b51ee9cb00ad4fa7cc08245875efab
                                    End

                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            TextAlign =3
                                            Top =5760
                                            Width =1800
                                            Height =435
                                            FontWeight =700
                                            Name ="labEvent_notes"
                                            Caption ="Current year event / logistics notes"
                                            FontName ="Arial"
                                            GUID = Begin
                                                0x34dfd0451d5bfb4e996f1d4214273617
                                            End
                                        End
                                    End
                                End
                                Begin TextBox
                                    AllowAutoCorrect = NotDefault
                                    ScrollBars =2
                                    OverlapFlags =215
                                    IMESentenceMode =3
                                    Left =1923
                                    Top =6720
                                    Width =9837
                                    Height =479
                                    TabIndex =3
                                    Name ="txtMisc_obs"
                                    ControlSource ="Misc_obs"
                                    StatusBarText ="Wildlife or plant phenology observations"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0x3d446fe7ee433c4b9915063025bbcf7a
                                    End

                                    Begin
                                        Begin Label
                                            OverlapFlags =215
                                            TextAlign =3
                                            Left =120
                                            Top =6720
                                            Width =1680
                                            Height =480
                                            FontWeight =700
                                            Name ="labMisc_obs"
                                            Caption ="Wildlife/phenology observations"
                                            FontName ="Arial"
                                            GUID = Begin
                                                0x6abb08c659b7c54a90bed44147c143f9
                                            End
                                        End
                                    End
                                End
                                Begin Subform
                                    OverlapFlags =247
                                    Left =180
                                    Top =7500
                                    Width =11340
                                    Height =1380
                                    TabIndex =4
                                    Name ="subNesting_Obs"
                                    SourceObject ="Form.fsub_Nesting_Obs"
                                    LinkChildFields ="Event_ID"
                                    LinkMasterFields ="Event_ID"
                                    GUID = Begin
                                        0x1cab2e60a4626049aab5455ad2628d91
                                    End

                                    Begin
                                        Begin Label
                                            OverlapFlags =223
                                            TextAlign =3
                                            Left =240
                                            Top =7260
                                            Width =1620
                                            Height =252
                                            FontWeight =700
                                            Name ="labNesting_Obs"
                                            Caption ="Nest observations"
                                            FontName ="Arial"
                                            GUID = Begin
                                                0xfa27f9e30c71754a959f27cfa1aac0e1
                                            End
                                        End
                                    End
                                End
                                Begin CommandButton
                                    Visible = NotDefault
                                    OverlapFlags =215
                                    Left =11880
                                    Top =4980
                                    Width =648
                                    Height =300
                                    FontWeight =700
                                    TabIndex =5
                                    Name ="cmdUndo"
                                    Caption ="Undo"
                                    OnClick ="[Event Procedure]"
                                    FontName ="Arial"
                                    ControlTipText ="Undo all edits to this record"
                                    GUID = Begin
                                        0x960d86e4700bc346893b6e8984c7b954
                                    End

                                    WebImagePaddingLeft =2
                                    WebImagePaddingTop =2
                                    WebImagePaddingRight =1
                                    WebImagePaddingBottom =1
                                End
                            End
                        End
                        Begin Page
                            OverlapFlags =247
                            Left =135
                            Top =1725
                            Width =12690
                            Height =7155
                            Name ="pgTasks"
                            Caption =" Task list"
                            GUID = Begin
                                0xf3a4243d9e1ebc489964b62db87f2cbb
                            End
                            WebImagePaddingLeft =2
                            WebImagePaddingTop =2
                            WebImagePaddingRight =2
                            WebImagePaddingBottom =2
                            Begin
                                Begin Subform
                                    OverlapFlags =247
                                    Left =188
                                    Top =1736
                                    Width =12591
                                    Height =7140
                                    Name ="subTasks"
                                    SourceObject ="Form.fsub_Task_List_Browser"
                                    LinkChildFields ="Location_ID"
                                    LinkMasterFields ="Location_ID"
                                    GUID = Begin
                                        0x2a097d7e019bc748b9371cc3b33e0b7b
                                    End

                                End
                            End
                        End
                        Begin Page
                            OverlapFlags =247
                            Left =135
                            Top =1725
                            Width =12690
                            Height =7155
                            Name ="pgPointCoordinates"
                            Caption =" Short point form / coordinates"
                            GUID = Begin
                                0x2b93398d67fb874bbd87ce15bc386668
                            End
                            WebImagePaddingLeft =2
                            WebImagePaddingTop =2
                            WebImagePaddingRight =2
                            WebImagePaddingBottom =2
                            Begin
                                Begin Subform
                                    OverlapFlags =247
                                    Left =188
                                    Top =1736
                                    Width =11316
                                    Height =7140
                                    Name ="subTransectVisitCoords"
                                    SourceObject ="Form.fsub_Transect_Visit_Coordinates"
                                    LinkChildFields ="Start_date"
                                    LinkMasterFields ="txtDate"
                                    OnExit ="[Event Procedure]"
                                    GUID = Begin
                                        0xd4e5df0c15d8e240b001ea774f153355
                                    End

                                End
                            End
                        End
                        Begin Page
                            OverlapFlags =247
                            Left =135
                            Top =1725
                            Width =12690
                            Height =7155
                            Name ="pgPointConditions"
                            Caption ="Point count conditions"
                            GUID = Begin
                                0x877f3ce2ac1b784fab41dcb95fa86141
                            End
                            WebImagePaddingLeft =2
                            WebImagePaddingTop =2
                            WebImagePaddingRight =2
                            WebImagePaddingBottom =2
                            Begin
                                Begin Subform
                                    OverlapFlags =247
                                    Left =188
                                    Top =1736
                                    Width =11928
                                    Height =3807
                                    Name ="subPointConditions"
                                    SourceObject ="Form.fsub_Point_Count_Conditions"
                                    LinkChildFields ="Start_date"
                                    LinkMasterFields ="txtDate"
                                    OnExit ="[Event Procedure]"
                                    GUID = Begin
                                        0x712b0ad12d97d64f827f57b022c04b8f
                                    End

                                End
                                Begin Subform
                                    OverlapFlags =247
                                    Left =180
                                    Top =5880
                                    Width =11928
                                    Height =3000
                                    TabIndex =1
                                    Name ="subOwlCalls"
                                    SourceObject ="Form.fsub_Owl_Calls"
                                    LinkChildFields ="Start_date"
                                    LinkMasterFields ="txtDate"
                                    OnExit ="[Event Procedure]"
                                    GUID = Begin
                                        0x2d94d2b581a25b44be9749c624f8ec67
                                    End

                                    Begin
                                        Begin Label
                                            OverlapFlags =255
                                            Left =180
                                            Top =5640
                                            Width =2880
                                            Height =252
                                            FontWeight =700
                                            Name ="labOwlCalls"
                                            Caption ="Spotted Owl Calling"
                                            FontName ="Arial"
                                            GUID = Begin
                                                0x85b0acc6a7c8c0478cb564bf9743fb8e
                                            End
                                        End
                                    End
                                End
                            End
                        End
                        Begin Page
                            Visible = NotDefault
                            OverlapFlags =247
                            Left =135
                            Top =1725
                            Width =12690
                            Height =7155
                            Name ="pgEventDetails"
                            Caption =" Event details"
                            GUID = Begin
                                0x06127750ac89e64ebcc8496b634f0009
                            End
                            WebImagePaddingLeft =2
                            WebImagePaddingTop =2
                            WebImagePaddingRight =2
                            WebImagePaddingBottom =2
                            Begin
                                Begin TextBox
                                    Visible = NotDefault
                                    TabStop = NotDefault
                                    AllowAutoCorrect = NotDefault
                                    SpecialEffect =3
                                    OverlapFlags =247
                                    BackStyle =0
                                    IMESentenceMode =3
                                    Left =3840
                                    Top =3240
                                    Name ="txtObserverRole"
                                    ControlSource ="=\"Transect visit log\""
                                    FontName ="Arial"
                                    GUID = Begin
                                        0x2a5ae9a255184944ab26b42f9acc93fb
                                    End

                                    Begin
                                        Begin Label
                                            OverlapFlags =247
                                            Left =2460
                                            Top =3240
                                            Width =1320
                                            Height =228
                                            Name ="labObserverRole"
                                            Caption ="form observer role"
                                            FontName ="Arial"
                                            GUID = Begin
                                                0x465d99d3d51ed24285895c9032175397
                                            End
                                        End
                                    End
                                End
                                Begin TextBox
                                    Visible = NotDefault
                                    TabStop = NotDefault
                                    AllowAutoCorrect = NotDefault
                                    SpecialEffect =3
                                    OverlapFlags =247
                                    BackStyle =0
                                    IMESentenceMode =3
                                    Left =3840
                                    Top =2940
                                    Width =2280
                                    TabIndex =1
                                    Name ="txtEvent_ID"
                                    ControlSource ="Event_ID"
                                    StatusBarText ="Unique identifier for each sampling event"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0x45c67fa6f956b24e98fe4959aef6324e
                                    End

                                    Begin
                                        Begin Label
                                            OverlapFlags =247
                                            Left =3060
                                            Top =2940
                                            Width =720
                                            Height =228
                                            Name ="labEvent_ID"
                                            Caption ="Event ID"
                                            FontName ="Arial"
                                            GUID = Begin
                                                0xd08d1ee84ea9f04190e8212ffeecc157
                                            End
                                        End
                                    End
                                End
                                Begin TextBox
                                    Visible = NotDefault
                                    TabStop = NotDefault
                                    AllowAutoCorrect = NotDefault
                                    SpecialEffect =3
                                    OverlapFlags =247
                                    BackStyle =0
                                    IMESentenceMode =3
                                    Left =3840
                                    Top =3900
                                    Width =720
                                    TabIndex =2
                                    Name ="txtDatum"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0xdd8d41e25bdf884094ee54bf828e41da
                                    End

                                    Begin
                                        Begin Label
                                            OverlapFlags =247
                                            Left =2940
                                            Top =3900
                                            Width =840
                                            Height =228
                                            Name ="labDatum"
                                            Caption ="form datum"
                                            FontName ="Arial"
                                            GUID = Begin
                                                0xda339e1de4eb294d90617b34dbc7f19c
                                            End
                                        End
                                    End
                                End
                                Begin TextBox
                                    Locked = NotDefault
                                    TabStop = NotDefault
                                    AllowAutoCorrect = NotDefault
                                    SpecialEffect =3
                                    OverlapFlags =247
                                    BackStyle =0
                                    IMESentenceMode =3
                                    Left =3840
                                    Top =3600
                                    Width =900
                                    TabIndex =3
                                    Name ="txtProject_code"
                                    ControlSource ="Project_code"
                                    StatusBarText ="Project code, for linking information with other data sets and applications"
                                    FontName ="Arial"
                                    GUID = Begin
                                        0x308f41760fade84882dd96351cb8b9a5
                                    End

                                    Begin
                                        Begin Label
                                            OverlapFlags =247
                                            Left =2820
                                            Top =3600
                                            Width =936
                                            Height =228
                                            Name ="labProject_code"
                                            Caption ="Project code"
                                            FontName ="Arial"
                                            GUID = Begin
                                                0xae94b58a90fa3c49929db53e5b3e2b46
                                            End
                                        End
                                    End
                                End
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =180
                    Top =840
                    Width =1920
                    Height =299
                    FontWeight =700
                    TabIndex =6
                    Name ="cmdLocSetup"
                    Caption ="Point sampling form"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ControlTipText ="Open the point sampling form"
                    GUID = Begin
                        0xe3a6464e4fba03479ba6ea20b00008de
                    End

                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =600
                    Top =120
                    Width =900
                    ColumnInfo ="\"\";\"\";\"10\";\"8\""
                    GUID = Begin
                        0xbcf565face10c8459a6b4c333f02c6b8
                    End
                    Name ="cmbPark"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tlu_Parks.Park_code FROM tlu_Parks ORDER BY tlu_Parks.Park_code; "
                    StatusBarText ="Park code"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Arial"
                    OnKeyDown ="[Event Procedure]"
                    OnGotFocus ="[Event Procedure]"

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Top =120
                            Width =477
                            Height =252
                            FontWeight =700
                            Name ="labPark_code"
                            Caption ="Park"
                            FontName ="Arial"
                            GUID = Begin
                                0xc57d00874c9569408e4e83545e0ccd3b
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =2220
                    Top =840
                    Width =1680
                    Height =299
                    FontWeight =700
                    TabIndex =9
                    Name ="cmdPointCounts"
                    Caption ="Point count data"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ControlTipText ="Open the point count data form"
                    GUID = Begin
                        0xdcb6d11778ca364aa9e024b10126eef1
                    End

                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =4020
                    Top =840
                    Width =1439
                    Height =299
                    FontWeight =700
                    TabIndex =10
                    Name ="cmdHabitat"
                    Caption ="Habitat data"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ControlTipText ="Open the habitat data form"
                    GUID = Begin
                        0x72332e377da79a47a3be48a0ab8ae42f
                    End

                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
            End
        End
        Begin FormFooter
            Height =1020
            BackColor =13884370
            Name ="FormFooter"
            GUID = Begin
                0xd55b0eb7003dd941975205d8797fa1f3
            End
            Begin
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =3
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =840
                    Top =60
                    BackColor =16777215
                    ForeColor =0
                    Name ="txtEntered_date"
                    ControlSource ="Entered_date"
                    Format ="mm/dd/yyyy hh:nn"
                    StatusBarText ="Date on which data entry occurred"
                    FontName ="Arial"
                    GUID = Begin
                        0xa82f993abc948a4daf868b4b4917e270
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =105
                            Top =60
                            Width =675
                            Height =255
                            BackColor =16777215
                            ForeColor =0
                            Name ="labEntered_date"
                            Caption ="Entered"
                            FontName ="Arial"
                            GUID = Begin
                                0xb87c3e1b3940794c95d500972fdaeb35
                            End
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =3
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =3360
                    Top =60
                    Width =2280
                    TabIndex =1
                    BackColor =16777215
                    ForeColor =0
                    Name ="txtEntered_by"
                    ControlSource ="Entered_by"
                    StatusBarText ="Person who entered the data for this event"
                    FontName ="Arial"
                    GUID = Begin
                        0x626fb33fdf91e84885bd38552c26bec1
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =2421
                            Top =60
                            Width =855
                            Height =255
                            BackColor =16777215
                            ForeColor =0
                            Name ="labEntered_by"
                            Caption ="Entered by"
                            FontName ="Arial"
                            GUID = Begin
                                0x080123a647b27d4e922236ea0e4b0b90
                            End
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =3
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =840
                    Top =360
                    TabIndex =2
                    BackColor =16777215
                    ForeColor =0
                    Name ="txtUpdated_date"
                    ControlSource ="Updated_date"
                    Format ="mm/dd/yyyy hh:nn"
                    StatusBarText ="Date of the most recent edits"
                    FontName ="Arial"
                    GUID = Begin
                        0x3a1fb7256b88a640a3543f2869b6da4a
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =60
                            Top =360
                            Width =720
                            Height =255
                            BackColor =16777215
                            ForeColor =0
                            Name ="labUpdated_date"
                            Caption ="Updated"
                            FontName ="Arial"
                            GUID = Begin
                                0x9688219524cd2c47b2131ec49a8982ff
                            End
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =3
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =3360
                    Top =360
                    Width =2280
                    TabIndex =3
                    BackColor =16777215
                    ForeColor =0
                    Name ="txtUpdated_by"
                    ControlSource ="Updated_by"
                    StatusBarText ="Person who made the most recent updates"
                    FontName ="Arial"
                    GUID = Begin
                        0x0826f7a821cc5c4684e25ffe37df7298
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =2376
                            Top =360
                            Width =900
                            Height =255
                            BackColor =16777215
                            ForeColor =0
                            Name ="labUpdated_by"
                            Caption ="Updated by"
                            FontName ="Arial"
                            GUID = Begin
                                0xf79871840ffeee46ad81d12274aa22f2
                            End
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =3
                    OldBorderStyle =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =840
                    Top =660
                    TabIndex =4
                    BackColor =16777215
                    ForeColor =0
                    Name ="txtVerified_date"
                    ControlSource ="Verified_date"
                    Format ="Short Date"
                    StatusBarText ="Date on which data were verified"
                    FontName ="Arial"
                    InputMask ="99/99/0000;0;_"
                    GUID = Begin
                        0x0602b2cfa62ae04b88654a94d4453b2e
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =90
                            Top =660
                            Width =690
                            Height =255
                            BackColor =16777215
                            ForeColor =0
                            Name ="labVerified_date"
                            Caption ="Verified"
                            FontName ="Arial"
                            GUID = Begin
                                0x61bcae9fdcf5e44da4096e57ec86c256
                            End
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =3
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =3360
                    Top =660
                    Width =2280
                    TabIndex =5
                    BackColor =16777215
                    ForeColor =0
                    Name ="txtVerified_by"
                    ControlSource ="Verified_by"
                    StatusBarText ="Person who verified accurate data transcription"
                    FontName ="Arial"
                    GUID = Begin
                        0x125b8c618823824a879a36b4557220e2
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =2406
                            Top =660
                            Width =870
                            Height =255
                            BackColor =16777215
                            ForeColor =0
                            Name ="labVerified_by"
                            Caption ="Verified by"
                            FontName ="Arial"
                            GUID = Begin
                                0x9ea844914412db48984cf7894208cac6
                            End
                        End
                    End
                End
                Begin TextBox
                    AllowAutoCorrect = NotDefault
                    ScrollBars =2
                    OldBorderStyle =0
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =6540
                    Top =360
                    Width =4680
                    Height =599
                    TabIndex =7
                    BackColor =16777215
                    ForeColor =0
                    Name ="txtQA_notes"
                    ControlSource ="QA_notes"
                    StatusBarText ="Quality assurance comments for the selected sampling event"
                    FontName ="Arial"
                    GUID = Begin
                        0x33a4ab0802939b4ba701b0a690dedd4f
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =5700
                            Top =360
                            Width =804
                            Height =228
                            BackColor =16777215
                            ForeColor =0
                            Name ="labQA_notes"
                            Caption ="QA notes"
                            FontName ="Arial"
                            GUID = Begin
                                0x3695a517b94daf4e9afdef9e15501104
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =11340
                    Top =120
                    Height =660
                    FontWeight =700
                    TabIndex =8
                    Name ="cmdVerify"
                    Caption ="Verify this sampling event"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ControlTipText ="Verifies that this record is complete and accurately reflects the field forms"
                    GUID = Begin
                        0x9f1f7f96e8400642968bdcc2fbf1985e
                    End

                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =8100
                    Top =60
                    Width =720
                    TabIndex =6
                    ConditionalFormat = Begin
                        0x010000006c000000010000000000000002000000000000000500000001010000 ,
                        0xff000000ffffff00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x540072007500650000000000
                    End
                    GUID = Begin
                        0xc95cbe9800ca7b46b346d443a8c0887d
                    End
                    Name ="cmbIs_excluded"
                    ControlSource ="Is_excluded"
                    RowSourceType ="Value List"
                    RowSource ="-1;Yes;0;No"
                    ColumnWidths ="0;576"
                    StatusBarText ="Flag to exclude the sampling event from data summary output"
                    BeforeUpdate ="[Event Procedure]"
                    FontName ="Arial"
                    ControlTipText ="Flag to exclude the sampling event from data summary output"

                    ConditionalFormat14 = Begin
                        0x010001000000000000000200000001010000ff000000ffffff00040000005400 ,
                        0x720075006500000000000000000000000000000000000000000000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =1
                            Left =5760
                            Top =60
                            Width =2280
                            Height =240
                            BackColor =16777215
                            ForeColor =0
                            Name ="labIs_excluded"
                            Caption ="Exclude from summary output:"
                            FontName ="Tahoma"
                            GUID = Begin
                                0x2a26c049241e5d4bbded0a5ccd945702
                            End
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

' =================================
' FORM NAME:    frm_Data_Entry
' Description:  Standard form - main project data entry form
' Data source:  In-line record source query based on Locations and Events tables
' Data access:  edit; allow additions off except for new records
' Pages:        pgTransectVisitLog, pgTasks, pgPointCoordinates, pgPointConditions,
'                   pgEventDetails
' Functions:    fxnResetForm
' References:   fxnGUIDGen, fxnSwitchboardIsOpen
' Source/date:  John R. Boetsch, July 2006
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    JRB, 5/21/2007 - updated code on cmbPark_AfterUpdate to have individual
'                   prompts for datum and declination
'               JRB, April 2008 - added pgTasks and subTasks; added code for
'                   setting the bookmark on the referring form
'               JRB, 6/11/2008 - added confirmation step before allowing edits to a certified
'                   record; updated txtDate_GotFocus to check for certified/duplicate records
'                   before updating the date field
'               JRB, 7/9/2008 - updated formatting; updated cmdVerify to include failsafe
'                   with no event; updated certified data check syntax
'               JRB, 10/23/2008 - limited bookmarking code to referrals from the Data Gateway;
'                   updated gvarRefForm/Ctl error code in cmdClose; updated Open to set up form
'                   according to AppMode; added checks for read-only in Current, Dirty,
'                   txtDate_GotFocus and txtEnd_date_GotFocus events; updated Undo, cmdUndo
'               JRB, 11/17/2008 - added code in Form_Open to automatically redirect 'incidental'
'                   locations and reset the filter for non-origin events
'               JRB, 5/20/2009 - added Trim() to inputbox commands for datum and declination;
'                   added requery command on exit from subTransectVisitCoords subform
'               JRB, 7/23/2009 - updated fxnResetForm and Form_Dirty, removed Form_BeforeInsert
'               JRB, 12/31/2009 - added cmbIs_excluded
'               BLC, 6/13/2014 - updated txtLoc_code_DblClick to use TempVars.Item("UserAccessLevel") vs. cAppMode
' =================================

Dim strCurrentUser As String
Dim strProjectCode As String
Dim varDeclination As Variant
Dim varEvent As Variant         ' The current point establishment event, if any

' ---------------------------------
' SUB:     Form_Open
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - updated to use TempVars.Item("UserAccessLevel") vs. cAppMode
'               BLC, 7/29/2014 - updated to use TempVars.Item("Park") vs. cPark,
'                                similarly for cProject,
' ---------------------------------
Private Sub Form_Open(Cancel As Integer)
    On Error GoTo Err_Handler

    Dim db As DAO.Database
    Dim rst As DAO.Recordset
    Dim varLoc As Variant
    Dim varEvent As Variant

    ' Close the form if the switchboard is not open
    If fxnSwitchboardIsOpen = False Then
        MsgBox "The main database switchboard must be" & vbCrLf & _
            "open for this form to function properly.", , "Cannot open the form ..."
        DoCmd.CancelEvent
        GoTo Exit_Procedure
    End If

    If Me.FilterOn Then
        Select Case Me.Location_type
          Case "Incidental"
            ' Opening a rare bird observation - notify user and redirect
            MsgBox "The main data entry form is not configured to handle" & vbCrLf & _
                "sample locations where location type='Incidental'." & vbCrLf & vbCrLf & _
                "You will be redirected to the rare bird observation form.", _
                , "Misdirected open form command"
            ' Open the rare bird observation data entry form
            DoCmd.OpenForm "frm_Rare_Bird_Obs", , , "[Event_ID]=""" & Me.Event_ID & _
                """"
            DoCmd.CancelEvent
            GoTo Exit_Procedure

          Case "Origin"
            ' Already at the origin record, do nothing
            ' Set the site/location and the unbound park code control
            Me.cmbSite = Me.Location_ID
            Me.cmbPark = Me.Park_code

          Case Else
            ' A new or existing sampling point .. must find the related origin record and
            '   set the open form filter to that record
            Set db = CurrentDb
            Set rst = db.OpenRecordset("SELECT tbl_Locations.Location_ID, " & _
                "tbl_Events.Event_ID FROM tbl_Locations " & _
                "INNER JOIN tbl_Events " & _
                "ON tbl_Locations.Location_ID = tbl_Events.Location_ID " & _
                "WHERE (((tbl_Locations.Site_ID)=""" & Me.Site_ID & _
                """) AND ((tbl_Locations.Location_type)='origin')" & _
                " AND ((tbl_Events.Start_date)=#" & Me.Start_date & "#));", dbOpenSnapshot)
            ' If no records ...
            If rst.EOF Then
                MsgBox "No transect events match this sample date.", vbExclamation, _
                    "No matching transect visit"
                DoCmd.CancelEvent
                GoTo Exit_Procedure
            End If
            varLoc = rst!Location_ID
            varEvent = rst!Event_ID
            ' Reset filter to the correct origin location and event
            Me.Filter = "[Event_ID]=""" & varEvent & """"
            Me.FilterOn = True
            ' Set the site/location and the unbound park code control
            Me.cmbSite = Me.Location_ID
            Me.cmbPark = Me.Park_code
            Me.cmbSite.Requery
        End Select

    Else    ' No filter set, opening to a blank record
        If IsNull(Me.OpenArgs) Then
        ' Missing required arguments
            MsgBox "Missing required information used to open the form." & vbCrLf & _
                "Please contact the developer.", , "Cannot open the form ..."
            DoCmd.CancelEvent
            GoTo Exit_Procedure
        End If
        ' Set the site/location and the unbound park code control
        Me.cmbSite = Me.OpenArgs
        Me.cmbPark = DLookup("Park_code", "tbl_Locations", "[Location_ID] = """ _
            & Me.cmbSite & """")
    End If

    ' Enable/disable subforms depending on application mode
    Select Case TempVars.item("UserAccessLevel")
      Case "admin", "power user", "data entry"
        Me.subObservers.Form.AllowEdits = True
        Me.subObservers.Form.AllowAdditions = True
        Me.subObservers.Form.AllowDeletions = True
        Me.subTransectVisitEvents.Form.AllowEdits = True
        Me.subTransectVisitEvents.Form.AllowAdditions = True
        Me.subTransectVisitEvents.Form.AllowDeletions = True
        Me.subNesting_Obs.Form.AllowEdits = True
        Me.subNesting_Obs.Form.AllowAdditions = True
        Me.subNesting_Obs.Form.AllowDeletions = True
        Me.subTasks.Form.AllowEdits = True
        Me.subTasks.Form.AllowAdditions = True
        Me.subTasks.Form.AllowDeletions = True
        Me.subTransectVisitCoords.Form.AllowEdits = True
        Me.subTransectVisitCoords.Form.AllowAdditions = True
        Me.subTransectVisitCoords.Form.AllowDeletions = True
        Me.subPointConditions.Form.AllowEdits = True
        Me.subPointConditions.Form.AllowAdditions = True
        Me.subPointConditions.Form.AllowDeletions = True
        Me.subOwlCalls.Form.AllowEdits = True
        Me.subOwlCalls.Form.AllowAdditions = True
        Me.cmdNewUser.Enabled = True
        Me.cmdNew.Enabled = True
        Me.cmdVerify.Enabled = True

      Case Else     ' read only mode
        Me.AllowEdits = False
        Me.cmbPark.Locked = True
        Me.cmbSite.Locked = True
        Me.txtDate.Locked = True

        Me.subObservers.Form.AllowEdits = False
        Me.subObservers.Form.AllowAdditions = False
        Me.subObservers.Form.AllowDeletions = False
        Me.subTransectVisitEvents.Form.AllowEdits = False
        Me.subTransectVisitEvents.Form.AllowAdditions = False
        Me.subTransectVisitEvents.Form.AllowDeletions = False
        Me.subNesting_Obs.Form.AllowEdits = False
        Me.subNesting_Obs.Form.AllowAdditions = False
        Me.subNesting_Obs.Form.AllowDeletions = False
        Me.subTasks.Form.AllowEdits = False
        Me.subTasks.Form.AllowAdditions = False
        Me.subTasks.Form.AllowDeletions = False
        Me.subTransectVisitCoords.Form.AllowEdits = False
        Me.subTransectVisitCoords.Form.AllowAdditions = False
        Me.subTransectVisitCoords.Form.AllowDeletions = False
        Me.subPointConditions.Form.AllowEdits = False
        Me.subPointConditions.Form.AllowAdditions = False
        Me.subPointConditions.Form.AllowDeletions = False
        Me.subOwlCalls.Form.AllowEdits = False
        Me.subOwlCalls.Form.AllowAdditions = False
        Me.cmdNewUser.Enabled = False
        Me.cmdNew.Enabled = False
        Me.cmdVerify.Enabled = False
    End Select

    ' If the form is not being opened to filter on an existing event, move to a new record
    '   (although the open call statement should specify acFormNew if not filtering on Event)
    If Me.FilterOn = False And Me.DataEntry = False Then DoCmd.GoToRecord , , acNewRec

    ' Set the current user and project code
    If IsNull(TempVars.item("User")) = False Then
        strCurrentUser = TempVars.item("User")
    Else
        strCurrentUser = Environ("Username")
    End If
    If IsNull(TempVars.item("Project")) = False Then
        strProjectCode = TempVars.item("Project")
    Else
        strProjectCode = "NONE"
    End If

    ' Set the datum and declination
    If Me.cmbPark = TempVars.item("Park") Then
        Me.txtDatum = TempVars.item("Datum")
        varDeclination = TempVars.item("Declination")
    Else
        Me.txtDatum = Null
        varDeclination = Null
    End If

Exit_Procedure:
    On Error Resume Next
    rst.Close
    Set rst = Nothing
    Set db = Nothing
    Exit Sub

Err_Handler:
    Select Case Err.Number
      Case 91     ' Object variable not set - resume next statement
        Resume Next
      Case 2467   ' Object does not exist - resume next statement
        Resume Next
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    End Select
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     Form_Current
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - updated to use TempVars.Item("UserAccessLevel") vs. cAppMode
' ---------------------------------
Private Sub Form_Current()
    On Error GoTo Err_Handler

    If Me.NewRecord = False Then
        Me.AllowAdditions = False
        ' On existing records, lock the header controls and enable the data entry controls
        Me.cmbSite.Locked = True
        Me.txtDate.Locked = True
        If Me.subObservers.Enabled = False Then Me.subObservers.Enabled = True
        If Me.pgTabs.Enabled = False Then Me.pgTabs.Enabled = True
        varEvent = Me.Event_ID
        Me.txtDate = Me.Start_date

        ' Requery the subforms
        '   (except subNesting_Obs, as it has a simple connection to parent rec)
        Me.subTransectVisitEvents.Requery
        Me.subTransectVisitCoords.Requery
        Me.subPointConditions.Requery
        Me.subOwlCalls.Requery
        ' Set focus to the first page
        Me.pgTransectVisitLog.SetFocus
    
    ElseIf TempVars.item("UserAccessLevel") = "read only" Then
        ' Form was opened to a new record in read only mode
        Me.cmbSite.Locked = True
        Me.cmbPark.Locked = True
        Me.txtDate.Locked = True
        varEvent = Null
        Me.txtDate = Null
        Me.cmdClose.SetFocus
    
    Else    ' New record
        If Me.AllowAdditions = False Then Me.AllowAdditions = True
        ' On new records, unlock the header controls and disable the data entry controls
        Me.cmbSite.Locked = False
        Me.txtDate.Locked = False
        If Me.subObservers.Enabled Then Me.subObservers.Enabled = False
        If Me.pgTabs.Enabled Then Me.pgTabs.Enabled = False
        varEvent = Null
        Me.txtDate = Null

        ' Requery the subforms
        '   (except subNesting_Obs, as it has a simple connection to parent rec)
        Me.subTransectVisitEvents.Requery
        Me.subTransectVisitCoords.Requery
        Me.subPointConditions.Requery
        Me.subOwlCalls.Requery
        ' Set focus to the date control
        Me.txtDate.SetFocus
    End If

    Me.cmdUndo.Visible = False

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

'Private Sub Form_BeforeInsert(Cancel As Integer)
'    On Error GoTo Err_Handler
'
' Note:  as currently configured, the insert event isn't triggered because new
'   records are inserted through SQL code in fxnResetForm.  The following is SOME of
'   the code that would need to be activated if this event were triggered.
'
'    ' Create the GUID primary key value
'    Me.txtEvent_ID = fxnGUIDGen
'
'    ' Set the project code
'    Me.Project_code = strProjectCode
'
'    ' Enable the form controls
'    Me.subObservers.Enabled = True
'    Me.pgTabs.Enabled = True
'    Me.cmdUndo.Visible = True
'
'Exit_Procedure:
'    Exit Sub
'
'Err_Handler:
'    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
'    Resume Exit_Procedure
'
'End Sub

' ---------------------------------
' SUB:     Form_Dirty
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - updated to use TempVars.Item("UserAccessLevel") vs. cAppMode
' ---------------------------------
Private Sub Form_Dirty(Cancel As Integer)
    On Error GoTo Err_Handler

    ' Note: this event is ignored on inserting a new record if BeforeInsert code exists

    ' First make sure that the record header is complete
    If IsNull(Me.cmbSite) Then
        MsgBox "Enter the transect first ...", , "Missing information"
        Me.cmbSite.SetFocus
        DoCmd.CancelEvent
        GoTo Exit_Procedure
    ElseIf IsNull(Me.txtDate) Then
        MsgBox "Enter the date first ...", , "Missing information"
        Me.txtDate.SetFocus
        DoCmd.CancelEvent
        GoTo Exit_Procedure
    End If

    ' Check if the current record is certified
    If IsNull(Me.Certified_date) = False And (IsNull(Me.Updated_date) Or _
            Me.Certified_date >= Me.Updated_date) Then

        Select Case TempVars.item("UserAccessLevel")
          Case "admin", "power user"
            ' Request confirmation before allowing edits
            If MsgBox("This record is certified ... are you certain you want to edit it?", _
                vbYesNo + vbExclamation + vbDefaultButton2, _
                "Confirm certified data edit") = vbNo Then
                DoCmd.CancelEvent
                GoTo Exit_Procedure
            End If
            Me.cmdUndo.Visible = True
            MsgBox "Please log the edits to certified data ..."
            DoCmd.OpenForm "frm_Edit_Log", , , , , , "Update tbl_Events"

          Case "data entry"
            ' Warn the user and disallow edits
            MsgBox "Edits to certified event data are not allowed in data entry mode", _
                vbOKOnly + vbCritical, "This event record has been certified"
            DoCmd.CancelEvent
            GoTo Exit_Procedure

          Case Else
            ' Read only
            DoCmd.CancelEvent
            GoTo Exit_Procedure
        End Select

    ElseIf TempVars.item("UserAccessLevel") = "read only" Then
        ' Edits not allowed
        DoCmd.CancelEvent
        GoTo Exit_Procedure
    Else
        Me.cmdUndo.Visible = True
    End If

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     Form_Undo
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub Form_Undo(Cancel As Integer)
    On Error GoTo Err_Handler

    Me.cmdUndo.Visible = False

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     Form_BeforeUpdate
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub Form_BeforeUpdate(Cancel As Integer)
    On Error GoTo Err_Handler

    ' Complete & validate the record prior to saving
    If IsNull(Me.Start_date) Then Me.Start_date = Me.txtDate
    If IsNull(Me.Project_code) Then Me.Project_code = strProjectCode
    If IsNull(Me.Declination) And IsNull(varDeclination) = False Then _
        Me.Declination = varDeclination

    ' Prior to saving, update the entered/updated info
    If Me.NewRecord Then
        Me.Entered_by = strCurrentUser
    Else
        Me.Updated_by = strCurrentUser
        Me.Updated_date = Now()
    End If

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     Form_AfterUpdate
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub Form_AfterUpdate()
    On Error GoTo Err_Handler

    Me.cmdUndo.Visible = False

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     cmbPark_GotFocus
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub cmbPark_GotFocus()
    On Error GoTo Err_Handler

    ' Save the record to avoid any data conflicts
    If Me.Dirty Then DoCmd.RunCommand acCmdSaveRecord

Exit_Procedure:
    Exit Sub

Err_Handler:
    Select Case Err.Number
      Case 2001   ' Run time canceled event (validation error)
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    End Select
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     cmbPark_KeyDown
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub cmbPark_KeyDown(KeyCode As Integer, Shift As Integer)
    On Error GoTo Err_Handler

    If KeyCode = vbKeyDown Or KeyCode = vbKeyUp Then
    ' Drop down or pull up the combo box list
        KeyCode = 0
        SendKeys "{F4}"
    End If

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     cmbPark_AfterUpdate
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub cmbPark_AfterUpdate()
    On Error GoTo Err_Handler

    Dim strDec As String
    Dim strDatum As String

    ' Move to a new record
    cmdNew_Click

    ' On changing the park, prompt for resetting the datum and declination
    If IsNull(varDeclination) Then strDec = "---" Else: strDec = varDeclination
    If IsNull(Me.txtDatum) Then strDatum = "---" Else: strDatum = Me.txtDatum
    If MsgBox("Please confirm the datum: " & strDatum, vbYesNo, "Confirm park info") _
        = vbNo Then _
        Me.txtDatum = Trim(InputBox("Enter the new datum (e.g., NAD83, NAD27, WGS84)"))
    If MsgBox("Please confirm the declination: " & strDec, vbYesNo, "Confirm park info") _
        = vbNo Then varDeclination = Trim(InputBox("Enter the new declination"))

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     cmbSite_GotFocus
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub cmbSite_GotFocus()
    On Error GoTo Err_Handler

    Me.ActiveControl.Requery

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     cmbSite_KeyDown
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub cmbSite_KeyDown(KeyCode As Integer, Shift As Integer)
    On Error GoTo Err_Handler

    If KeyCode = vbKeyDown Or KeyCode = vbKeyUp Then
    ' Drop down or pull up the combo box list
        KeyCode = 0
        SendKeys "{F4}"
    End If

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     cmbSite_NotInList
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub cmbSite_NotInList(NewData As String, Response As Integer)
    On Error GoTo Err_Handler

    Me.ActiveControl.Undo

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     cmbSite_AfterUpdate
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub cmbSite_AfterUpdate()
    On Error GoTo Err_Handler

    If IsNull(Me.cmbSite) = False And IsNull(Me.txtDate) = False Then fxnResetForm

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     txtDate_GotFocus
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - updated to use TempVars.Item("UserAccessLevel") vs. cAppMode
' ---------------------------------
Private Sub txtDate_GotFocus()
    On Error GoTo Err_Handler

    Dim vResponse As VbMsgBoxResult
    Dim varDate As Variant
    Dim strSQL As String

    Dim rst As DAO.Recordset    ' Recordset of child records if changing the date
    Dim intNumRecs As Integer   ' Number of records in recordset
    Dim intI As Integer         ' Counter for looping through recordset
    Dim varReturn As Variant
    Dim strMsg As String
    Dim intNumCert As Integer   ' For counting the number of certified records to be updated
    Dim blnDuplicate As Boolean ' Flag for indicating whether a duplicate event exists

    ' Bail out if in read only mode
    If TempVars.item("UserAccessLevel") = "read only" Then GoTo Exit_Procedure

    If Me.txtDate.Locked Then
        vResponse = MsgBox("Do you want to create a new event?" & vbCrLf & vbCrLf & _
            "Select YES to create a new event record," & vbCrLf & _
            "Select NO to change the date associated with this event," & vbCrLf & _
            "or CANCEL to do nothing.", _
            vbYesNoCancel + vbDefaultButton3, "Date change options")
        Select Case vResponse
          Case vbYes    ' New event
            varDate = CDate(InputBox("Enter the event date:", "New event date"))
            ' Validate the date entered before proceeding
            If varDate = Me.txtDate Then
                ' Same date entered, so no changes needed
                MsgBox "The same date entered ... no changes were made"
                GoTo Exit_Procedure
            ElseIf IsNull(Me.txtDate) = False Then
                If varDate > Now() Then
                    MsgBox "You cannot enter a date in the future.", _
                        vbCritical, "Validation error"
                    GoTo Exit_Procedure
                ElseIf Now() - varDate > 180 Then
                    If MsgBox("You are trying to enter a date more than 6 months old." & _
                        vbCrLf & "Are you sure this is the correct date?", _
                        vbYesNo + vbQuestion + vbDefaultButton2, _
                        "Please confirm date") = vbNo Then
                        GoTo Exit_Procedure
                    End If
                End If
            End If
            ' Change/unlock the date (to avoid this message after observer update)
            Me.txtDate = varDate
            Me.txtDate.Locked = False
            varEvent = Null
            fxnResetForm

          Case vbNo     ' Change event date
            varDate = CDate(InputBox("Enter the new date:", "Change event date"))
            ' Validate the date entered before proceeding
            If varDate = Me.txtDate Then
                ' Same date entered, so no changes needed
                MsgBox "The same date entered ... no changes were made"
                GoTo Exit_Procedure
            ElseIf IsNull(Me.txtDate) = False Then
                If varDate > Now() Then
                    MsgBox "You cannot enter a date in the future.", _
                        vbCritical, "Validation error"
                    GoTo Exit_Procedure
                ElseIf Now() - varDate > 180 Then
                    If MsgBox("You are trying to enter a date more than 6 months old." & _
                        vbCrLf & "Are you sure this is the correct date?", _
                        vbYesNo + vbQuestion + vbDefaultButton2, _
                        "Please confirm date") = vbNo Then
                        GoTo Exit_Procedure
                    End If
                End If
            End If

Change_Child_Dates:
            ' Set the recordset - should be the same as the point conditions recordset
            Set rst = Me.subPointConditions.Form.Recordset

            ' Counts the number of linked records in the recordset
            ' Note: must move to last record for an accurate record count; if no records,
            '   just change the date in the parent record
            If rst.BOF Then GoTo Change_Parent_Date Else rst.MoveLast
            intNumRecs = rst.RecordCount
            ' Confirm one more time that the dates should be changed
            If intNumRecs > 1 Then
                strMsg = "Warning: There are " & intNumRecs & " linked records that" _
                    & vbCrLf & "will also have their dates changed ... "
            Else
                strMsg = "Warning: There is 1 child record that" _
                    & vbCrLf & "will also have its date changed ... "
            End If
            If MsgBox(strMsg, vbOKCancel, "Confirm date change for child records") _
                = vbCancel Then
                MsgBox "No dates were changed"
                GoTo Exit_Procedure
            End If

            ' Loop through the recordset to check for certified records before performing
            '   the updates. Also check that the changes won't result in duplicates on
            '   Location_ID and Start_date
            intNumCert = 0
            blnDuplicate = False
            rst.MoveFirst
            Do Until rst.EOF
                ' Check if the current record is certified ... if so increment the counter
                If IsNull(rst![Certified_date]) = False And _
                    rst![Certified_date] >= rst![Updated_date] Then _
                        intNumCert = intNumCert + 1
                ' Check for existing event records with that location-date combination
                If DCount("*", "tbl_Events", "[Location_ID]=""" & rst![Location_ID] & _
                    """ AND [Start_date]=#" & varDate & "#") > 0 Then blnDuplicate = True
                rst.MoveNext
            Loop
            ' If a duplicate would be created, skip the child updates and move on
            If blnDuplicate Then GoTo Change_Parent_Date
            ' If there was at least one certified record ...
            If intNumCert > 0 Then
                If TempVars.item("UserAccessLevel") = "data entry" Then
                ' For data entry applications, warn the user and disallow edits
                    MsgBox _
                        "At least one of the records you wish to update has been certified." _
                        & vbCrLf & _
                        "Changes to certified records are not permitted in data entry mode.", _
                        vbOKOnly + vbCritical, "Cannot update certified records"
                    GoTo Exit_Procedure
                Else
                    If IsNull(Me.Certified_date) = False And (IsNull(Me.Updated_date) Or _
                        Me.Certified_date >= Me.Updated_date) Then intNumCert = intNumCert + 1
                ' For other application modes, request confirmation before allowing edits
                    If MsgBox("This will change dates for " & intNumCert & _
                        " certified records ..." _
                        & vbCrLf & _
                        "Are you certain you want to go ahead with these changes?", _
                        vbYesNo + vbExclamation + vbDefaultButton2, _
                        "Confirm certified data edit") = vbNo Then
                        MsgBox "No dates were changed"
                        GoTo Exit_Procedure
                    End If
                    MsgBox "Please log the edits to certified data ..."
                    DoCmd.OpenForm "frm_Edit_Log", , , , , , "Update tbl_Events"
                End If
            End If

            ' Initialize the system meter to indicate progress
            varReturn = SysCmd(acSysCmdInitMeter, "Changing dates", intNumRecs)
            intI = 0
            rst.MoveFirst

            ' Loop through each record and change the dates to the new date
            Do Until rst.EOF
                intI = intI + 1
                varReturn = SysCmd(acSysCmdUpdateMeter, intI)
                With rst
                    .Edit
                    !Start_date = varDate
                    !Updated_date = Now()
                    !Updated_by = strCurrentUser
                    .Update
                    .Bookmark = .LastModified
                End With
                rst.MoveNext
            Loop

Change_Parent_Date:
            ' Check for existing event records with that location-date combination
            If DCount("*", "tbl_Events", "[Location_ID]=""" & Me.Location_ID & _
                """ AND [Start_date]=#" & varDate & "#") > 0 Then blnDuplicate = True
            If blnDuplicate Then
                MsgBox "Event record(s) with the same location(s) and date already exist." & _
                    vbCrLf & vbCrLf & "No dates were changed.", vbOKOnly + vbCritical, _
                    "Unable to change date"
                GoTo Exit_Procedure
            End If
            
            ' Check for certified record (again, in case the child rec routine was skipped)
            If intNumCert > 0 Then
                ' Do nothing, since the user was already prompted to confirm updates
            ElseIf IsNull(Me.Certified_date) = False And (IsNull(Me.Updated_date) Or _
                    Me.Certified_date >= Me.Updated_date) Then
                If TempVars.item("UserAccessLevel") = "data entry" Then
                ' For data entry applications, warn the user and disallow edits
                    MsgBox "Changes to certified records are not permitted in data entry mode.", _
                        vbOKOnly + vbCritical, "Cannot update certified records"
                    GoTo Exit_Procedure
                Else
                ' For other application modes, request confirmation before allowing edits
                    If MsgBox("This will change the date for a certified record ..." _
                        & vbCrLf & "Are you certain you want to go ahead with this update?", _
                        vbYesNo + vbExclamation + vbDefaultButton2, _
                        "Confirm certified data edit") _
                        = vbNo Then
                        MsgBox "No dates were changed"
                        GoTo Exit_Procedure
                    End If
                    MsgBox "Please log the edits to certified data ..."
                    DoCmd.OpenForm "frm_Edit_Log", , , , , , "Update tbl_Events"
                End If
            End If

            ' Change the date control, update query to update the date in the event record
            Me.txtDate = varDate
            ' Update query to update the date in the event record
            If IsNull(varEvent) = False Then
                strSQL = "UPDATE tbl_Events SET tbl_Events.Start_date = #" & varDate & _
                    "#, tbl_Events.Updated_by = """ & strCurrentUser & _
                    """, tbl_Events.Updated_date = Now() WHERE (((tbl_Events.Event_ID)= """ _
                    & varEvent & """));"
                DoCmd.SetWarnings False
                DoCmd.RunSQL strSQL
                DoCmd.SetWarnings True
            Else: MsgBox "Error:  varEvent is Null"
            End If

          Case vbCancel
            ' Nothing
        End Select
    End If

Exit_Procedure:
    On Error Resume Next
    DoCmd.SetWarnings True
    varReturn = SysCmd(acSysCmdRemoveMeter)
    Set rst = Nothing
    Exit Sub

Err_Handler:
    Select Case Err.Number
      Case 13
        If MsgBox("Enter a proper date", vbOKCancel, "Type mismatch") = vbCancel Then
            Resume Exit_Procedure
        Else: Resume    ' Keep running the same line asking for a date if user didn't cancel
        End If
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    End Select
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     txtDate_BeforeUpdate
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub txtDate_BeforeUpdate(Cancel As Integer)
    On Error GoTo Err_Handler

    ' Validate the date entered before proceeding
    If IsNull(Me.ActiveControl) = False Then
        If Me.txtDate > Now() Then
            MsgBox "You cannot enter a date in the future.", _
                vbCritical, "Validation error"
            DoCmd.CancelEvent
        ElseIf Now() - Me.txtDate > 180 Then
            If MsgBox("You are trying to enter a date more than 6 months old." & _
                vbCrLf & "Are you sure this is the correct date?", vbYesNo + vbQuestion, _
                "Please confirm date") = vbNo Then DoCmd.CancelEvent
        End If
    End If

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     txtDate_AfterUpdate
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub txtDate_AfterUpdate()
    On Error GoTo Err_Handler
    
    If IsNull(Me.cmbSite) = False And IsNull(Me.txtDate) = False Then fxnResetForm

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     cmdNew_Click
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub cmdNew_Click()
    On Error GoTo Err_Handler

    ' When user wants a new record, move to a blank record and reset the form
    If Me.Dirty Then DoCmd.RunCommand acCmdSaveRecord
    If Me.AllowAdditions = False Then Me.AllowAdditions = True
    Me.DataEntry = True
    Me.cmbSite = Null
    Me.txtDate = Null
    Me.cmbSite.SetFocus

Exit_Procedure:
    Exit Sub

Err_Handler:
    Select Case Err.Number
      Case 2001   ' Run time canceled event (validation error) - exit procedure without
                '   moving to a new record
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    End Select
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     cmdNewUser_Click
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub cmdNewUser_Click()
    On Error GoTo Err_Handler

    ' Set the global reference control variable for requerying after updates
    Set gvarRefContactCtl = Me.subObservers!cmbContact_ID
    ' Open the contacts form
    DoCmd.OpenForm "frm_Contacts", , , , , , "new"

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          cmbIs_excluded_BeforeUpdate
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John Boetsch - NCCN Landbirds db
' Adapted:      Bonnie Campbell, May 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/19/2014 - Replaced cAppMode with TempVars.Item("UserAccessLevel")
' ---------------------------------
Private Sub cmbIs_excluded_BeforeUpdate(Cancel As Integer)
    On Error GoTo Err_Handler

    Select Case TempVars.item("UserAccessLevel")
      Case "admin", "power user"    ' Change is permitted
        Dim strMsgConfirm As String
    
        ' Warn the user about changing the value
        If Me.ActiveControl = True Then
            strMsgConfirm = "Checking this box means that data for this sampling" & _
                vbCrLf & "event won't appear in data summary output ... are you sure?"
        Else
            strMsgConfirm = "Unchecking this box means that data for this sampling" & _
                vbCrLf & "event will now appear in data summary output ... are you sure?"
        End If
        If MsgBox(strMsgConfirm, vbYesNo + vbExclamation + vbDefaultButton2, _
            "Confirm change") = vbNo Then
            Me.ActiveControl.Undo
            DoCmd.CancelEvent
        End If

      Case Else
        MsgBox "Only those with power user privileges can make this change"
        Me.ActiveControl.Undo
        DoCmd.CancelEvent
    End Select

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     cmdVerify_Click
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - updated to use TempVars.Item("UserAccessLevel") vs. cAppMode
' ---------------------------------
Private Sub cmdVerify_Click()
    On Error GoTo Err_Handler

    Dim strSQL As String

    ' Bail out if in read only mode
    If TempVars.item("UserAccessLevel") = "read only" Then GoTo Exit_Procedure

    ' Bail out if no event record
    If IsNull(Me.Event_ID) Then GoTo Exit_Procedure

    ' Save the record to avoid any data conflicts
    If Me.Dirty Then DoCmd.RunCommand acCmdSaveRecord

    ' Update the verified by/date through a query so as not to trigger before update event
    strSQL = "UPDATE tbl_Events SET tbl_Events.Verified_by = """ & strCurrentUser _
        & """, tbl_Events.Verified_date = #" & Now() & "# WHERE ((tbl_Events.Event_ID)=""" _
        & Me.Event_ID & """);"
    DoCmd.SetWarnings False
    DoCmd.RunSQL strSQL
    DoCmd.SetWarnings True
    Me.Requery

Exit_Procedure:
    DoCmd.SetWarnings True
    Exit Sub

Err_Handler:
    Select Case Err.Number
      Case 2001   ' Run time canceled event (validation error)
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    End Select
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     cmdClose_Click
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub cmdClose_Click()
    On Error GoTo Err_Handler

    Dim rst As DAO.Recordset
    Dim strCondition As String

    ' Save the record (to trigger validation), then close and requery the referring form
    If Me.Dirty Then DoCmd.RunCommand acCmdSaveRecord

    If IsNull(Me.Event_ID) Then
        strCondition = "[Location_ID]=""" & Me.Location_ID & """"
    Else
        strCondition = "[Location_ID]=""" & Me.Location_ID & _
            """ AND [Event_ID]=""" & Me.Event_ID & """"
    End If

    DoCmd.Close , , acSaveNo
    gvarRefForm.Requery
    gvarRefCtl.Requery

    If gvarRefForm.name = "frm_Data_Gateway" Then
        ' Bookmark the record on the referring form
        Set rst = gvarRefForm.RecordsetClone
        rst.FindFirst strCondition
        If rst.NoMatch Then
            ' MsgBox "No entry found.", vbInformation
        Else
            gvarRefForm.Bookmark = rst.Bookmark
        End If
    End If

Exit_Procedure:
    On Error Resume Next
    Set rst = Nothing
    Exit Sub

Err_Handler:
    Select Case Err.Number
      Case 2001   ' Run time canceled event (validation error) - exit without closing
      Case 91     ' Do nothing - object variable not set
      Case 2467   ' Do nothing - object does not exist
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    End Select
    Resume Exit_Procedure

End Sub

' =================================
' The next set of procedures opens the specified popup data entry forms

' ---------------------------------
' SUB:     cmdLocSetup_Click
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub cmdLocSetup_Click()
    On Error GoTo Err_Handler

    ' Bail out if no event
    If IsNull(Me.Event_ID) Then GoTo Exit_Procedure

    ' Save the record to trigger validation and avoid data conflicts
    If Me.Dirty Then DoCmd.RunCommand acCmdSaveRecord

    ' Open the form and pass the date and site
    DoCmd.OpenForm "frm_Point_Establishment", , , , , , "SitID=" & Me.Site_ID

Exit_Procedure:
    Exit Sub

Err_Handler:
    Select Case Err.Number
      Case 2001   ' Run time canceled event (validation error)
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    End Select
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     cmdPointCounts_Click
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub cmdPointCounts_Click()
    On Error GoTo Err_Handler

    ' Bail out if no event
    If IsNull(Me.Event_ID) Then GoTo Exit_Procedure

    ' Save the record to trigger validation and avoid data conflicts
    If Me.Dirty Then DoCmd.RunCommand acCmdSaveRecord

    ' Open the point count data entry form and filter by event
    DoCmd.OpenForm "frm_Point_Counts", , , "[Event_ID]=""" & Me.Event_ID & _
        """", , , Me.Event_ID

Exit_Procedure:
    Exit Sub

Err_Handler:
    Select Case Err.Number
      Case 2001   ' Run time canceled event (validation error)
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    End Select
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     cmdHabitat_Click
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub cmdHabitat_Click()
    On Error GoTo Err_Handler

    ' Bail out if no event
    If IsNull(Me.Event_ID) Then GoTo Exit_Procedure

    ' Save the record to trigger validation and avoid data conflicts
    If Me.Dirty Then DoCmd.RunCommand acCmdSaveRecord

    ' Open the habitat data entry form and filter by event
    DoCmd.OpenForm "frm_Habitat", , , "[Event_ID]=""" & Me.Event_ID & _
        """", acFormEdit, , Me.Event_ID

Exit_Procedure:
    Exit Sub

Err_Handler:
    Select Case Err.Number
      Case 2001   ' Run time canceled event (validation error)
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    End Select
    Resume Exit_Procedure

End Sub

' =================================
' PAGE NAME:    Transect visit log (pgTransectVisitLog)
' Description:  Transect visit log form, with events for sampling points and nesting obs
' Unbound ctls: none
' Subforms:     subTransectVisitEvents, subNesting_Obs
' =================================

' ---------------------------------
' SUB:     cmdUndo_Click
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub cmdUndo_Click()
    On Error GoTo Err_Handler

    ' When user wants to undo changes to a record ...
    '   undo changes to current record, move to a blank record and reset the form
    If MsgBox("Undo all changes to this record?", vbYesNo, "Confirm undo") = vbYes Then
        Me.cmdClose.SetFocus
        Me.cmdUndo.Visible = False
        Me.Undo
    End If

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     subTransectVisitEvents_Exit
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub subTransectVisitEvents_Exit(Cancel As Integer)
    On Error GoTo Err_Handler

    ' Requery the other subforms that depend on the same records
    Me.subTransectVisitCoords.Requery
    Me.subPointConditions.Requery
    Me.subOwlCalls.Requery

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' =================================
' PAGE NAME:    Task list (pgTasks)
' Description:  Continuation of the first page, for site tasks
' Unbound ctls: none
' Subforms:     subTasks
' =================================

' =================================
' PAGE NAME:    Short point form / coordinates (pgPointCoordinates)
' Description:  Short form for sampling point coordinates
' Unbound ctls: none
' Subforms:     subTransectVisitCoords
' =================================
' ---------------------------------
' SUB:     subTransectVisitCoords_Exit
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub subTransectVisitCoords_Exit(Cancel As Integer)
    On Error GoTo Err_Handler

    ' Requery the other subforms that depend on the same records
    Me.subTransectVisitEvents.Requery
    Me.subPointConditions.Requery
    Me.subOwlCalls.Requery

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' =================================
' PAGE NAME:    Point count conditions (pgPointConditions)
' Description:  Point count conditions form, with spotted owl observation records
' Unbound ctls: none
' Subforms:     subPointConditions, subOwlCalls
' =================================

' ---------------------------------
' SUB:     subPointConditions_Exit
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub subPointConditions_Exit(Cancel As Integer)
    On Error GoTo Err_Handler

    ' Requery the other subforms that depend on the same records
    Me.subTransectVisitCoords.Requery
    Me.subTransectVisitEvents.Requery
    Me.subOwlCalls.Requery

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:     subOwlCalls_Exit
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 6/13/2014 - XX
' ---------------------------------
Private Sub subOwlCalls_Exit(Cancel As Integer)
    On Error GoTo Err_Handler

    ' Requery the other subforms that depend on the same records
    Me.subTransectVisitCoords.Requery
    Me.subTransectVisitEvents.Requery
    Me.subPointConditions.Requery

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' =================================
' PAGE NAME:    Event details (pgEventDetails)
' Description:  Shows the quality assurance and data entry details for the selected record
' Unbound ctls: none
' Subforms:     none
' =================================

' ---------------------------------
' FUNCTION:          fxnResetForm
' Description:  Moves to the record selected by the site and date controls if one exists
'               or creates a new record if not - and resets the form filter
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, July 2006
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    JRB, 7/23/2009 - removed condition to create the new event record only if
'                   varEvent was null, because the Form_BeforeInsert event does not exist
'               BLC, 6/13/2014 - XX
' ---------------------------------
Private Function fxnResetForm()
    On Error GoTo Err_Handler

    Dim strCondition As String
    Dim strSQL As String

    strCondition = "[Location_ID] = """ & Me.cmbSite & _
        """ And [Start_date] = #" & Me![txtDate] & "#"

    ' If there is an existing record with the same date and location ID
    '   move to that record, and remove the data entry setting
    If DCount("*", "tbl_Events", strCondition) > 0 Then
        ' Me.DataEntry = False - found this to be unnecessary when setting the filter
        Me.Filter = strCondition
        Me.FilterOn = True
        Me.subTransectVisitEvents.SetFocus
    Else
        ' Create a new event record
        ' Create the GUID primary key value
        varEvent = fxnGUIDGen
        ' Insert the event record
        strSQL = "INSERT INTO tbl_Events " & _
            "( Event_ID, Location_ID, Start_date, Project_code, Entered_by ) SELECT """ _
            & varEvent & """ AS Event_ID, """ _
            & Me.cmbSite & """ AS Location_ID, #" _
            & Me.txtDate & "# AS Start_date, """ _
            & strProjectCode & """ AS Project_code, """ _
            & strCurrentUser & """ AS Entered_by;"
        DoCmd.SetWarnings False
        DoCmd.RunSQL strSQL
        DoCmd.SetWarnings True
        ' Me.DataEntry = False - found this to be unnecessary for now
        Me.Filter = strCondition
        Me.FilterOn = True
        Me.subObservers.SetFocus
    End If

Exit_Procedure:
    DoCmd.SetWarnings True
    Exit Function

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
        "Error encountered (#" & Err.Number & " - fxnResetForm)"
    Resume Exit_Procedure

End Function