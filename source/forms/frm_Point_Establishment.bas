Version =20
VersionRequired =20
Checksum =748571192
Begin Form
    AllowFilters = NotDefault
    PopUp = NotDefault
    Modal = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    DataEntry = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularFamily =48
    BorderStyle =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridX =24
    GridY =24
    Width =11880
    DatasheetFontHeight =10
    ItemSuffix =121
    Left =3750
    Top =2085
    Right =15630
    Bottom =11430
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0xd044d8a8ac01e340
    End
    Caption =" Point Establishment Form"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0004030101000000340000000500000004000000943f280000000000943f2800 ,
        0x010400069c004c2053ff000201000100ea0a6f08640001000f00580201000100 ,
        0x5802030001004c657474657200000000f4e86328340000001439280001040301 ,
        0xa0ff8c0314390000000000000000000000000000010000000000000001000000 ,
        0x0200000029010000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200280a640ce813159f23d70000000000000000000000000000000000000000 ,
        0x00000000000000004f0000000000000000000000000000000000000000000000 ,
        0x0000000001000000010000000000000000000000000000000000000000000000 ,
        0x0500030004000300040004000400000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000001000100010001000100010001000100000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000000000000000000280a0000534d544a ,
        0x000000001000180a48005000200043006f006c006f00720020004c0061007300 ,
        0x650072004a006500740020004300500034003000320030002000530065007200 ,
        0x6900650073002000500043004c0036000000496e70757442696e00464f524d53 ,
        0x4f5552434500524553444c4c00556e69726573444c4c004850446f6355495355 ,
        0x49005472756500455350524954537570706f727465640054727565005265736f ,
        0x6c7574696f6e0036303064706900466173745265730046616c73650048505068 ,
        0x79736963616c4f7269656e746174696f6e00504f5f506f727472616974004f72 ,
        0x69656e746174696f6e00504f5254524149540048504f7269656e74526f746174 ,
        0x653138300046616c7365004475706c6578004e4f4e4500506170657253697a65 ,
        0x004c4554544552004d6564696154797065004155544f00436f6c6c617465004f ,
        0x4e0048504d65646961547970655472656576696577506f707570005472756500 ,
        0x436f6c6f724d6f646500323462707000546578744173426c61636b0046616c73 ,
        0x6500545441734269746d61707353657474696e670054544d6f64654f75746c69 ,
        0x6e65004a504547456e61626c65004175746f00416c7465726e6174654c657474 ,
        0x6572486561640046616c7365004850506170657253697a65414c4d436f6e7374 ,
        0x7261696e74730053544154454d454e540048504561726c795761726d5570436f ,
        0x6d6d616e6400456e61626c65004850437573746f6d4455706c657861626c6552 ,
        0x616e676500332e383778352e38335f382e35783134005468726573686f6c644d ,
        0x6f706965724844003238384d42005072696e745175616c69747947726f757000 ,
        0x505147726f75705f31004850446f6350726f705265736f757263654461746100 ,
        0x687063686c3039312e636162004850436f6c6f72536d617274004175746f6d61 ,
        0x746963004850436f6c6f72536d6172745f436f6c6f724f7074696f6e735f4564 ,
        0x6765436f6e74726f6c004e6f726d616c004850436f6c6f72536d6172745f5465 ,
        0x78745f4e65757472616c477261797300426c61636b4f6e6c79004850436f6c6f ,
        0x72536d6172745f546578745f48616c66746f6e650044657461696c004850436f ,
        0x6c6f72536d6172745f47726170686963735f4e65757472616c47726179730042 ,
        0x6c61636b4f6e6c79004850436f6c6f72536d6172745f47726170686963735f48 ,
        0x616c66746f6e650044657461696c004850436f6c6f72536d6172745f50686f74 ,
        0x6f5f4e65757472616c477261797300342d436f6c6f72004850436f6c6f72536d ,
        0x6172745f50686f746f5f48616c66746f6e650044657461696c004850436f6c6f ,
        0x724d6f646500434f4c4f525f4d4f444500485050444c547970650050444c5f50 ,
        0x434c36004850504a4c456e636f64696e6700555446380048504a6f624163636f ,
        0x756e74696e670048504a4f42414343545f4a4f4241434e545f434f4c4f524155 ,
        0x54480048504a6f6242794a6f624f76657272696465004a424a4f0048504a6f62 ,
        0x416363576f50696e0054727565004850584d4c46696c65557365640068706334 ,
        0x353230362e786d6c0048504d616e75616c4475706c65784469616c6f67497465 ,
        0x6d7300496e737472756374696f6e49445f30315f46414345444f574e2d4e4f52 ,
        0x4f54415445004850506170657253697a654475706c6578436f6e73747261696e ,
        0x74730053544154454d454e540048504d65646961547970654475706c6578436f ,
        0x6e73747261696e7473005452414e53504152454e435900485050434c36506173 ,
        0x735468726f7567680054727565004850536d6172744475706c657853696e676c ,
        0x65506167654a6f620054727565004850536d6172744475706c65784f64645061 ,
        0x67654a6f6200547275650048504d616e75616c466565644f7269656e74617469 ,
        0x6f6e004641434555500048504f757470757442696e4f7269656e746174696f6e ,
        0x0046414345444f574e0048504d616e75616c4475706c65784469616c6f674d6f ,
        0x64656c004d6f64656c6573730048504d61704d616e75616c46656564546f5472 ,
        0x61793100547275650048504d616e75616c4475706c657850616765526f746174 ,
        0x6500447269766572526f746174650048505072696e744f6e426f746853696465 ,
        0x734d616e75616c6c790046616c73650048505072696e74496e47726179536361 ,
        0x6c650046616c73650048504e5573654469666646697273745061676543686f69 ,
        0x6365005452554500485050616765457863657074696f6e7346696c6500485043 ,
        0x504530393100485050616765457863657074696f6e73496e7465726661636500 ,
        0x53686f7750616765457863657074696f6e730048505061676545786365707469 ,
        0x6f6e7300436f766572496e73657274696f6e0048504475706c69636174654a6f ,
        0x624e616d654f766572726964650053574657004850506e67506173737468726f ,
        0x7567680054727565005053416c69676e6d656e7446696c65004850434c533039 ,
        0x31004850536d6172744875625f4f6e6c696e65646961676e6f73746963746f6f ,
        0x6c730054525545004850536d6172744875625f537570706f7274616e6474726f ,
        0x75626c6573686f6f74696e670054525545004850536d6172744875625f50726f ,
        0x647563746d616e75616c730054525545004850536d6172744875625f43686563 ,
        0x6b666f72647269766572757064617465730054525545004850536d6172744875 ,
        0x625f436f6c6f727072696e74696e676163636573737573616765005452554500 ,
        0x4850536d6172744875625f4f72646572737570706c6965730054525545005053 ,
        0x53657276696365735f5072696e74636f6c6f7275736167656a6f626c6f670054 ,
        0x52554500505353657276696365735f446576696365616e64537570706c696573 ,
        0x537461747573005452554500505353657276696365734f7074696f6e00505353 ,
        0x6572766963657344756d6d794f7074696f6e004850536d61727448756200496e ,
        0x65745f5349445f3236335f4249445f3531345f4849445f323635004850436f6e ,
        0x73756d6572437573746f6d50617065720054727565004850456e61626c655241 ,
        0x5753706f6f6c696e67005472756500524742436f6c6f720044656661756c742d ,
        0x73524742004a52436f6e73747261696e7473004a524348445061727469616c00 ,
        0x4a524844496e7374616c6c6564004a5248444f6666004a5248444e6f74496e73 ,
        0x74616c6c6564004a5248444f666600485042657374476c6f7373004445464155 ,
        0x4c5400485045617379436f6c6f72004f6e0048504d48444c4c4e616d65004850 ,
        0x4649453039310000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0xe81300004955504817000100789ced99416b13411886df4d404a555ae8c18397 ,
        0x5c14bd04841cd48ab2d96cdad0c6ae5dc182f550d38d14d246d216f4660f22fe ,
        0x057f82fd13397a15bc8a474b7f8178b0beb34964b3edb41e826bc9fb0cdfcecc ,
        0x37333b43e6db6f3233073340c50fe6afc08121d7975eae473e917618d6e367fe ,
        0x4f3d132f22c20e43840e6c38389c6c4f0047094cfb0bd6167f8f938a6dfc629f ,
        0x053cc516da9408cf46d0b7385f68fec71b973e6a036b68653d109109254ad04f ,
        0x0fd68b6eb73b142771fab27eace4cd83b3fa4aaf47392af2cef07a95ae53c612 ,
        0x1e32d4e0c3a3b5d639da32d38b0c621cb8c759dfe5bfa93636e9a776e8ad1ab8 ,
        0x9ff5a0c43fc6b148ba2cdd66289d3bfd9d49fd14e5665f994c2719e86de5a589 ,
        0x9e0831e0b2b197b336664288b1c3b68e08214687f9c4aadc4b34e25d4507af51 ,
        0x4005119ad4eda245ed76d64314ff11e6acc3d84c3dde7b766833db9426eda4c0 ,
        0xbd698321a246362384c896234a71ca5efe998e6cf292bdfc3be5e7457bb93942 ,
        0x317795f5d0f53c3f0c8bfe8a6ff4b6f399514afabce5b4f3971bc97c0ed38331 ,
        0x7ab88b5504b1177fc1e71a36e9c5abf4ecadd88baf9ee8e5971837637dc41ac9 ,
        0xdc2d94e2362157028fc1672a4491f10a7cfbcf2832e7797cebb9c5798c3893c6 ,
        0x0e5e5217d10e741726c4b8a00317d1a316b85e65f949259c731f7b6e50bb3abb ,
        0x5f7d573af0f7be7cbb3df36876e158838d0f5fdf5effe1bfbf7678e7e3f4ab4f ,
        0x41509e77fde5e084570b2184104208218410e21cf11b406174c4000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000
    End
    PrtDevNames = Begin
        0x08002d0066000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000048504449555f31302e3134382e38332e353800
    End
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    FilterOnLoad =0
    AllowLayoutView =0
    DatasheetGridlinesColor12 =12632256
    PrtDevModeW = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x430050004e00200048005000200043006f006c006f00720020004c0000000000 ,
        0x01040006dc004c2053ff000201000100ea0a6f08640001000f00580201000100 ,
        0x5802030001004c00650074007400650072000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000029010000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200280a640ce813159f23d70000000000000000000000000000000000000000 ,
        0x00000000000000004f0000000000000000000000000000000000000000000000 ,
        0x0000000001000000010000000000000000000000000000000000000000000000 ,
        0x0500030004000300040004000400000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000001000100010001000100010001000100000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000000000000000000280a0000534d544a ,
        0x000000001000180a48005000200043006f006c006f00720020004c0061007300 ,
        0x650072004a006500740020004300500034003000320030002000530065007200 ,
        0x6900650073002000500043004c0036000000496e70757442696e00464f524d53 ,
        0x4f5552434500524553444c4c00556e69726573444c4c004850446f6355495355 ,
        0x49005472756500455350524954537570706f727465640054727565005265736f ,
        0x6c7574696f6e0036303064706900466173745265730046616c73650048505068 ,
        0x79736963616c4f7269656e746174696f6e00504f5f506f727472616974004f72 ,
        0x69656e746174696f6e00504f5254524149540048504f7269656e74526f746174 ,
        0x653138300046616c7365004475706c6578004e4f4e4500506170657253697a65 ,
        0x004c4554544552004d6564696154797065004155544f00436f6c6c617465004f ,
        0x4e0048504d65646961547970655472656576696577506f707570005472756500 ,
        0x436f6c6f724d6f646500323462707000546578744173426c61636b0046616c73 ,
        0x6500545441734269746d61707353657474696e670054544d6f64654f75746c69 ,
        0x6e65004a504547456e61626c65004175746f00416c7465726e6174654c657474 ,
        0x6572486561640046616c7365004850506170657253697a65414c4d436f6e7374 ,
        0x7261696e74730053544154454d454e540048504561726c795761726d5570436f ,
        0x6d6d616e6400456e61626c65004850437573746f6d4455706c657861626c6552 ,
        0x616e676500332e383778352e38335f382e35783134005468726573686f6c644d ,
        0x6f706965724844003238384d42005072696e745175616c69747947726f757000 ,
        0x505147726f75705f31004850446f6350726f705265736f757263654461746100 ,
        0x687063686c3039312e636162004850436f6c6f72536d617274004175746f6d61 ,
        0x746963004850436f6c6f72536d6172745f436f6c6f724f7074696f6e735f4564 ,
        0x6765436f6e74726f6c004e6f726d616c004850436f6c6f72536d6172745f5465 ,
        0x78745f4e65757472616c477261797300426c61636b4f6e6c79004850436f6c6f ,
        0x72536d6172745f546578745f48616c66746f6e650044657461696c004850436f ,
        0x6c6f72536d6172745f47726170686963735f4e65757472616c47726179730042 ,
        0x6c61636b4f6e6c79004850436f6c6f72536d6172745f47726170686963735f48 ,
        0x616c66746f6e650044657461696c004850436f6c6f72536d6172745f50686f74 ,
        0x6f5f4e65757472616c477261797300342d436f6c6f72004850436f6c6f72536d ,
        0x6172745f50686f746f5f48616c66746f6e650044657461696c004850436f6c6f ,
        0x724d6f646500434f4c4f525f4d4f444500485050444c547970650050444c5f50 ,
        0x434c36004850504a4c456e636f64696e6700555446380048504a6f624163636f ,
        0x756e74696e670048504a4f42414343545f4a4f4241434e545f434f4c4f524155 ,
        0x54480048504a6f6242794a6f624f76657272696465004a424a4f0048504a6f62 ,
        0x416363576f50696e0054727565004850584d4c46696c65557365640068706334 ,
        0x353230362e786d6c0048504d616e75616c4475706c65784469616c6f67497465 ,
        0x6d7300496e737472756374696f6e49445f30315f46414345444f574e2d4e4f52 ,
        0x4f54415445004850506170657253697a654475706c6578436f6e73747261696e ,
        0x74730053544154454d454e540048504d65646961547970654475706c6578436f ,
        0x6e73747261696e7473005452414e53504152454e435900485050434c36506173 ,
        0x735468726f7567680054727565004850536d6172744475706c657853696e676c ,
        0x65506167654a6f620054727565004850536d6172744475706c65784f64645061 ,
        0x67654a6f6200547275650048504d616e75616c466565644f7269656e74617469 ,
        0x6f6e004641434555500048504f757470757442696e4f7269656e746174696f6e ,
        0x0046414345444f574e0048504d616e75616c4475706c65784469616c6f674d6f ,
        0x64656c004d6f64656c6573730048504d61704d616e75616c46656564546f5472 ,
        0x61793100547275650048504d616e75616c4475706c657850616765526f746174 ,
        0x6500447269766572526f746174650048505072696e744f6e426f746853696465 ,
        0x734d616e75616c6c790046616c73650048505072696e74496e47726179536361 ,
        0x6c650046616c73650048504e5573654469666646697273745061676543686f69 ,
        0x6365005452554500485050616765457863657074696f6e7346696c6500485043 ,
        0x504530393100485050616765457863657074696f6e73496e7465726661636500 ,
        0x53686f7750616765457863657074696f6e730048505061676545786365707469 ,
        0x6f6e7300436f766572496e73657274696f6e0048504475706c69636174654a6f ,
        0x624e616d654f766572726964650053574657004850506e67506173737468726f ,
        0x7567680054727565005053416c69676e6d656e7446696c65004850434c533039 ,
        0x31004850536d6172744875625f4f6e6c696e65646961676e6f73746963746f6f ,
        0x6c730054525545004850536d6172744875625f537570706f7274616e6474726f ,
        0x75626c6573686f6f74696e670054525545004850536d6172744875625f50726f ,
        0x647563746d616e75616c730054525545004850536d6172744875625f43686563 ,
        0x6b666f72647269766572757064617465730054525545004850536d6172744875 ,
        0x625f436f6c6f727072696e74696e676163636573737573616765005452554500 ,
        0x4850536d6172744875625f4f72646572737570706c6965730054525545005053 ,
        0x53657276696365735f5072696e74636f6c6f7275736167656a6f626c6f670054 ,
        0x52554500505353657276696365735f446576696365616e64537570706c696573 ,
        0x537461747573005452554500505353657276696365734f7074696f6e00505353 ,
        0x6572766963657344756d6d794f7074696f6e004850536d61727448756200496e ,
        0x65745f5349445f3236335f4249445f3531345f4849445f323635004850436f6e ,
        0x73756d6572437573746f6d50617065720054727565004850456e61626c655241 ,
        0x5753706f6f6c696e67005472756500524742436f6c6f720044656661756c742d ,
        0x73524742004a52436f6e73747261696e7473004a524348445061727469616c00 ,
        0x4a524844496e7374616c6c6564004a5248444f6666004a5248444e6f74496e73 ,
        0x74616c6c6564004a5248444f666600485042657374476c6f7373004445464155 ,
        0x4c5400485045617379436f6c6f72004f6e0048504d48444c4c4e616d65004850 ,
        0x4649453039310000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0xe81300004955504817000100789ced99416b13411886df4d404a555ae8c18397 ,
        0x5c14bd04841cd48ab2d96cdad0c6ae5dc182f550d38d14d246d216f4660f22fe ,
        0x057f82fd13397a15bc8a474b7f8178b0beb34964b3edb41e826bc9fb0cdfcecc ,
        0x37333b43e6db6f3233073340c50fe6afc08121d7975eae473e917618d6e367fe ,
        0x4f3d132f22c20e43840e6c38389c6c4f0047094cfb0bd6167f8f938a6dfc629f ,
        0x053cc516da9408cf46d0b7385f68fec71b973e6a036b68653d109109254ad04f ,
        0x0fd68b6eb73b142771fab27eace4cd83b3fa4aaf47392af2cef07a95ae53c612 ,
        0x1e32d4e0c3a3b5d639da32d38b0c621cb8c759dfe5bfa93636e9a776e8ad1ab8 ,
        0x9ff5a0c43fc6b148ba2cdd66289d3bfd9d49fd14e5665f994c2719e86de5a589 ,
        0x9e0831e0b2b197b336664288b1c3b68e08214687f9c4aadc4b34e25d4507af51 ,
        0x4005119ad4eda245ed76d64314ff11e6acc3d84c3dde7b766833db9426eda4c0 ,
        0xbd698321a246362384c896234a71ca5efe998e6cf292bdfc3be5e7457bb93942 ,
        0x317795f5d0f53c3f0c8bfe8a6ff4b6f399514afabce5b4f3971bc97c0ed38331 ,
        0x7ab88b5504b1177fc1e71a36e9c5abf4ecadd88baf9ee8e5971837637dc41ac9 ,
        0xdc2d94e2362157028fc1672a4491f10a7cfbcf2832e7797cebb9c5798c3893c6 ,
        0x0e5e5217d10e741726c4b8a00317d1a316b85e65f949259c731f7b6e50bb3abb ,
        0x5f7d573af0f7be7cbb3df36876e158838d0f5fdf5effe1bfbf7678e7e3f4ab4f ,
        0x41509e77fde5e084570b2184104208218410e21cf11b406174c4000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000
    End
    PrtDevNamesW = Begin
        0x0400290062000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000480050004400490055005f00310030002e003100340038002e003800 ,
        0x33002e00350038000000
    End
    NoSaveCTIWhenDisabled =1
    Begin
        Begin Label
            BackStyle =0
            BackColor =-2147483633
            ForeColor =-2147483630
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            PictureAlignment =2
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
            BorderLineStyle =0
        End
        Begin OptionButton
            SpecialEffect =2
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
        End
        Begin CheckBox
            SpecialEffect =2
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
        End
        Begin BoundObjectFrame
            SpecialEffect =2
            OldBorderStyle =0
            BorderLineStyle =0
            BackStyle =0
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            BorderLineStyle =0
            BackColor =-2147483643
            ForeColor =-2147483640
            AsianLineBreak =255
        End
        Begin ListBox
            SpecialEffect =2
            BorderLineStyle =0
            BackColor =-2147483643
            ForeColor =-2147483640
        End
        Begin ComboBox
            SpecialEffect =2
            BorderLineStyle =0
            BackColor =-2147483643
            ForeColor =-2147483640
        End
        Begin Subform
            SpecialEffect =2
            BorderLineStyle =0
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
        End
        Begin ToggleButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
            BorderLineStyle =0
        End
        Begin Tab
            BackStyle =0
            BorderLineStyle =0
        End
        Begin FormHeader
            Height =480
            BackColor =9677753
            Name ="FormHeader"
            GUID = Begin
                0x483371a70978234f954b0cceb0fe49da
            End
            Begin
                Begin TextBox
                    AllowAutoCorrect = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =4200
                    Top =120
                    Height =252
                    ColumnOrder =2
                    FontSize =9
                    TabIndex =2
                    Name ="txtDate"
                    Format ="Short Date"
                    BeforeUpdate ="[Event Procedure]"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Arial"
                    OnGotFocus ="[Event Procedure]"
                    GUID = Begin
                        0x1b59a357576ea943ab19d8353648e394
                    End
                    ShowDatePicker =0

                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3660
                            Top =120
                            Width =480
                            Height =252
                            FontSize =9
                            FontWeight =700
                            Name ="labDate"
                            Caption ="Date"
                            FontName ="Arial"
                            GUID = Begin
                                0x450c4ed20a9e8848b2cf781c0e19c3c2
                            End
                        End
                    End
                End
                Begin ComboBox
                    AllowAutoCorrect = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =3
                    ListRows =20
                    ListWidth =2160
                    Left =2640
                    Top =120
                    Width =900
                    ColumnWidth =972
                    ColumnOrder =1
                    FontSize =9
                    TabIndex =1
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"20\""
                    GUID = Begin
                        0x73f1d8a24da6b04eb9b6af06267940d2
                    End
                    Name ="cmbSite"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tbl_Sites.Site_ID, tbl_Sites.Site_code, tbl_Sites.Site_status FROM tbl_Si"
                        "tes WHERE (((tbl_Sites.Park_code)=[Forms]![frm_Point_Establishment]![cmbPark])) "
                        "ORDER BY tbl_Sites.Site_status, tbl_Sites.Site_code;"
                    ColumnWidths ="0;720;1440"
                    StatusBarText ="Site membership of the sample location (transect)"
                    FontName ="Arial"
                    OnKeyDown ="[Event Procedure]"
                    OnGotFocus ="[Event Procedure]"
                    OnNotInList ="[Event Procedure]"

                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =1680
                            Top =120
                            Width =912
                            Height =252
                            FontSize =9
                            FontWeight =700
                            Name ="labSite"
                            Caption ="Transect"
                            FontName ="Arial"
                            GUID = Begin
                                0x22ad6c23ff114145a3f4ca038efd9b46
                            End
                        End
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    Left =9600
                    Top =60
                    Width =1080
                    FontSize =9
                    FontWeight =700
                    TabIndex =4
                    Name ="cmdNew"
                    Caption ="New site"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ControlTipText ="Move to a new transect"
                    GUID = Begin
                        0xdf3b39a9dff86b498fb447bd4b0cd525
                    End

                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =11040
                    Top =60
                    Width =660
                    FontSize =9
                    FontWeight =700
                    TabIndex =5
                    Name ="cmdClose"
                    Caption ="Close"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ControlTipText ="Close the form"
                    GUID = Begin
                        0x96ae7d325d217a4e906b225d2053c5eb
                    End

                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    AllowAutoCorrect = NotDefault
                    OverlapFlags =215
                    IMESentenceMode =3
                    ColumnCount =2
                    ListRows =20
                    ListWidth =3600
                    Left =6768
                    Top =120
                    Width =2568
                    Height =252
                    ColumnOrder =3
                    FontSize =9
                    TabIndex =3
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"100\""
                    GUID = Begin
                        0xb051cdd5749c2f4796795e7fbb462cf4
                    End
                    Name ="cmbObserver"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tlu_Project_Crew.Contact_ID, IIf([Contact_is_active],'Active','') AS Is_a"
                        "ctive FROM tlu_Project_Crew ORDER BY IIf([Contact_is_active],'Active','') DESC ,"
                        " tlu_Project_Crew.Contact_ID;"
                    ColumnWidths ="2592;1008"
                    StatusBarText ="Observer identifier"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Arial"
                    OnKeyDown ="[Event Procedure]"
                    OnGotFocus ="[Event Procedure]"
                    OnNotInList ="[Event Procedure]"

                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =5820
                            Top =120
                            Width =960
                            Height =252
                            FontSize =9
                            FontWeight =700
                            Name ="labObserver"
                            Caption ="Observer"
                            FontName ="Arial"
                            GUID = Begin
                                0x56d0de19c11d684cb3c21ba131db045b
                            End
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =660
                    Top =120
                    Width =900
                    ColumnOrder =0
                    FontSize =9
                    ColumnInfo ="\"\";\"\";\"10\";\"8\""
                    GUID = Begin
                        0x579d22489123444c9d32a68c07be439d
                    End
                    Name ="cmbPark"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tlu_Parks.Park_code FROM tlu_Parks ORDER BY tlu_Parks.Park_code; "
                    StatusBarText ="Park code"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Arial"
                    OnKeyDown ="[Event Procedure]"

                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =120
                            Top =120
                            Width =492
                            Height =252
                            FontSize =9
                            FontWeight =700
                            Name ="labPark_code"
                            Caption ="Park"
                            FontName ="Arial"
                            GUID = Begin
                                0x663ac94d649f93429b3e39e85a17291b
                            End
                        End
                    End
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =8280
            BackColor =13692912
            Name ="Detail"
            GUID = Begin
                0x61faf518a7c0954f86a0e2f2fd0f95aa
            End
            Begin
                Begin TextBox
                    AllowAutoCorrect = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =720
                    Top =180
                    Width =1080
                    Height =252
                    ColumnWidth =552
                    FontSize =9
                    TabIndex =1
                    Name ="txtPoint"
                    StatusBarText ="Alphanumeric code for the sample location (e.g., NN1, or TO for transect origin)"
                    BeforeUpdate ="[Event Procedure]"
                    FontName ="Arial"
                    InputMask =">Aaaa<aa"
                    OnGotFocus ="[Event Procedure]"
                    GUID = Begin
                        0x10c5574f0ba953489969a65ebbd47aa6
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =120
                            Top =180
                            Width =552
                            Height =252
                            FontSize =9
                            FontWeight =700
                            Name ="labPoint"
                            Caption ="Point"
                            FontName ="Arial"
                            GUID = Begin
                                0xf150fc6c8d27724b922e90b9ba84aaf7
                            End
                        End
                    End
                End
                Begin OptionGroup
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    Left =5640
                    Top =60
                    Width =3240
                    Height =480
                    TabIndex =3
                    Name ="optgVisitType"
                    StatusBarText ="Indicates whether this was the first site visit or a return visit"
                    AfterUpdate ="[Event Procedure]"
                    OnEnter ="[Event Procedure]"
                    GUID = Begin
                        0xc2741ceb9b1df14797d9108ee5d3ff8d
                    End

                    Begin
                        Begin Label
                            OverlapFlags =215
                            Left =5700
                            Top =180
                            Width =828
                            Height =252
                            FontSize =9
                            FontWeight =700
                            Name ="labVisitType"
                            Caption ="Visit type"
                            FontName ="Arial"
                            GUID = Begin
                                0xb9aaadc59752b745b086b3a4fc854985
                            End
                        End
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =6660
                            Top =180
                            Width =1020
                            Height =299
                            OptionValue =1
                            Name ="optFirstVisit"
                            Caption ="First visit"
                            GUID = Begin
                                0x77b3d0f1aaa43f4f8273251d83d19119
                            End

                            WebImagePaddingLeft =2
                            WebImagePaddingTop =2
                            WebImagePaddingRight =1
                            WebImagePaddingBottom =1
                        End
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =7800
                            Top =180
                            Width =1008
                            Height =299
                            OptionValue =0
                            Name ="optReturnVisit"
                            Caption ="Return visit"
                            GUID = Begin
                                0x0cb36d4b96c9f14d8bd5aa91167f311a
                            End

                            WebImagePaddingLeft =2
                            WebImagePaddingTop =2
                            WebImagePaddingRight =1
                            WebImagePaddingBottom =1
                        End
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    Left =9600
                    Top =120
                    Width =2100
                    FontSize =9
                    FontWeight =700
                    TabIndex =5
                    Name ="cmdNewPoint"
                    Caption ="Same site, next point"
                    OnClick ="[Event Procedure]"
                    FontName ="Arial"
                    ControlTipText ="Move to a new record, but keep the transect, observer and date"
                    GUID = Begin
                        0x4229f8db44c064438a7916e8c745a758
                    End

                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
                Begin OptionGroup
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    Left =1980
                    Top =60
                    Width =3540
                    Height =480
                    TabIndex =2
                    Name ="optgPointType"
                    StatusBarText ="Indicates the type of sample location"
                    BeforeUpdate ="[Event Procedure]"
                    ControlTipText ="Indicates the type of sample location"
                    GUID = Begin
                        0xfd69db5f0feae042a36db48027c9f7c1
                    End

                    Begin
                        Begin Label
                            OverlapFlags =215
                            Left =2160
                            Top =180
                            Width =960
                            Height =252
                            FontSize =9
                            FontWeight =700
                            Name ="labPointType"
                            Caption ="Point type"
                            FontName ="Arial"
                            GUID = Begin
                                0xb0ff3024421d3e43adc3fa767cb02de2
                            End
                        End
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =4380
                            Top =180
                            Width =1020
                            Height =299
                            OptionValue =1
                            Name ="optSurvey"
                            Caption ="Survey"
                            GUID = Begin
                                0x871f8893f6fe4246b2fda48911434a6e
                            End

                            WebImagePaddingLeft =2
                            WebImagePaddingTop =2
                            WebImagePaddingRight =1
                            WebImagePaddingBottom =1
                        End
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =3246
                            Top =184
                            Width =1008
                            Height =299
                            OptionValue =0
                            Name ="optOrigin"
                            Caption ="Origin"
                            GUID = Begin
                                0x533e6050dc4f1e4c8b6b1714e14d5d6a
                            End

                            WebImagePaddingLeft =2
                            WebImagePaddingTop =2
                            WebImagePaddingRight =1
                            WebImagePaddingBottom =1
                        End
                    End
                End
                Begin Subform
                    Visible = NotDefault
                    OverlapFlags =85
                    SpecialEffect =3
                    Top =660
                    Width =11880
                    Height =7620
                    TabIndex =4
                    Name ="subEvents"
                    LinkChildFields ="Event_ID"
                    LinkMasterFields ="txtEvent"
                    GUID = Begin
                        0x95891ce45589a040b7920a40fefbd48b
                    End

                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =9180
                    Top =120
                    Width =0
                    Height =0
                    Name ="cmdCursorStop"
                    StatusBarText ="No use - only the first tab stop on the form to avoid error messages"
                    GUID = Begin
                        0x0a8b5954d5b66241adcbe9cedabe315f
                    End

                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                End
            End
        End
        Begin FormFooter
            Height =600
            BackColor =9677753
            Name ="FormFooter"
            GUID = Begin
                0xfb53159e5e770e4bb5f11cd8af84d1dd
            End
            Begin
                Begin ComboBox
                    LimitToList = NotDefault
                    Locked = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =3
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =5760
                    Left =5460
                    Top =60
                    Width =1380
                    TabIndex =1
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"20\""
                    GUID = Begin
                        0x81e1c1be14167e4f8c9a13225069f1c9
                    End
                    Name ="cmbStatus"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tlu_Site_Status.Site_status, tlu_Site_Status.Site_status_desc FROM tlu_Si"
                        "te_Status ORDER BY tlu_Site_Status.Sort_order; "
                    ColumnWidths ="1008;4752"
                    StatusBarText ="Status of the location (blank for incidental locations)"
                    DefaultValue ="\"Active\""
                    FontName ="Arial"

                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =4800
                            Top =60
                            Width =600
                            Height =228
                            Name ="labStatus"
                            Caption ="Status"
                            FontName ="Arial"
                            GUID = Begin
                                0x3a87ddafbc78324dbffde80454860fb3
                            End
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =3
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =1026
                    Top =60
                    Width =3648
                    Name ="txtLocation_ID"
                    StatusBarText ="Unique identifier for each sample location"
                    FontName ="Arial"
                    GUID = Begin
                        0xd09a787f022448419d0a514439054709
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =60
                            Top =60
                            Width =840
                            Height =228
                            Name ="labLocation_ID"
                            Caption ="Location ID"
                            FontName ="Arial"
                            GUID = Begin
                                0xb0fc0d1590890d4897e06343bdecaed1
                            End
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =3
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =8016
                    Top =60
                    Width =1158
                    TabIndex =2
                    Name ="txtLoc_established"
                    Format ="Short Date"
                    StatusBarText ="Date the sample location was established"
                    FontName ="Arial"
                    GUID = Begin
                        0xbae62ad17fbe7644ae1ced662c18a2cc
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =6960
                            Top =60
                            Width =936
                            Height =228
                            Name ="labLoc_established"
                            Caption ="Established"
                            FontName ="Arial"
                            GUID = Begin
                                0x59a59c59c604ac409f3271a7dff5b5b3
                            End
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =3
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =10500
                    Top =60
                    Width =1158
                    TabIndex =3
                    Name ="txtLoc_discontinued"
                    Format ="Short Date"
                    StatusBarText ="Date the sample location was discontinued"
                    FontName ="Arial"
                    GUID = Begin
                        0x974d98352aff844da45d341f3ef4f605
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            TextAlign =3
                            Left =9360
                            Top =60
                            Width =1020
                            Height =228
                            Name ="labLoc_discontinued"
                            Caption ="Discontinued"
                            FontName ="Arial"
                            GUID = Begin
                                0x41fc6464e1427a45826cc19f2ed322f6
                            End
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =3
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =1860
                    Top =360
                    TabIndex =4
                    Name ="txtObserverRole"
                    ControlSource ="=\"Point description\""
                    FontName ="Arial"
                    GUID = Begin
                        0xe3d61e85d39359489d27da6a9a96f2b8
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =480
                            Top =360
                            Width =1320
                            Height =228
                            Name ="labObserverRole"
                            Caption ="form observer role"
                            FontName ="Arial"
                            GUID = Begin
                                0x062589dc5a01e544954f309cb653c2cf
                            End
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =3
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =4380
                    Top =360
                    Width =720
                    TabIndex =5
                    Name ="txtDatum"
                    FontName ="Arial"
                    GUID = Begin
                        0x5f779c19d8eb3e4eb8c643d1ef4b953e
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =3480
                            Top =360
                            Width =840
                            Height =228
                            Name ="labDatum"
                            Caption ="form datum"
                            FontName ="Arial"
                            GUID = Begin
                                0x7fa8817bef8a1249b6a3195ad820536e
                            End
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    TabStop = NotDefault
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =3
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Left =6180
                    Top =360
                    Width =2940
                    TabIndex =6
                    Name ="txtEvent"
                    FontName ="Arial"
                    GUID = Begin
                        0x663ff9e322d1a841bd1eb878ba15a84a
                    End

                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =5280
                            Top =360
                            Width =840
                            Height =228
                            Name ="labFormEvent"
                            Caption ="form event"
                            FontName ="Arial"
                            GUID = Begin
                                0x10a5bd5d3647ba4897a66901d7cbd356
                            End
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

' =================================
' FORM NAME:    frm_Point_Establishment
' Description:  Data entry form for point establishment and relocation information
' Data source:  unbound form
' Data access:  edit, add; no delete
' Pages:        none
' Functions:    fxnSetFocus, fxnInsertEvent, fxnInsertObserver, fxnResetForm, fxnLoadForm
' References:   fxnGUIDGen, fxnSwitchboardIsOpen
' Source/date:  John R. Boetsch, July 2006
' Revisions:    JRB, 5/21/2007 - Updated code on cmbPark_AfterUpdate to have individual prompts for
'                   datum and declination
'               JRB, April 2008 - Added cmdCursorStop as the first cursor focus point on the form
'                   to avoid getting error messages when the form initially opens and before
'                   the final cursor focus is determined with fxnSetFocus; added code for
'                   setting the bookmark on the referring form
'               JRB, 6/11/2008 -  added confirmation step before allowing edits to a certified record;
'                   updated txtDate_GotFocus to check for certified/duplicate records before updating
'                   the date field; updated Form_Open to cancel if switchboard not open
'               JRB, 7/9/2008 - updated certified data check syntax
'               JRB, 10/14/2008 - limited bookmarking code to referrals from the Data Gateway;
'                   updated gvarRefForm/Ctl error code in cmdClose
'               JRB, 8/3/2010 - removed setfocus from cmbObserver_KeyDown for tab/right key
'               JRB, 7/19/2011 - updated fxnInsertEvent to fix a bug when adding events to existing locs
' =================================

Dim strCurrentUser As String
Dim strProjectCode As String
Dim varDeclination As Variant
Dim varEvent As Variant         ' The current point establishment event, if any

' ---------------------------------
' SUB:          Form_Open
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - updated to use TempVars.Item("UserAccessLevel") vs. cAppMode,
'                                similarly with cPark, cProject, cUser, cDatum, cDelcination
' ---------------------------------
Private Sub Form_Open(Cancel As Integer)
    On Error GoTo Err_Handler

    ' Default form settings: cmdNew and cmdNewPoint disabled, all ctls null and unlocked,
    '   and subEvents invisible and disconnected

    Dim strArgType As String, strOpenArgs As String

    ' Close the form if the switchboard is not open
    If fxnSwitchboardIsOpen = False Then
        MsgBox "The main database switchboard must be" & vbCrLf & _
            "open for this form to function properly.", , "Cannot open the form ..."
        DoCmd.CancelEvent
        GoTo Exit_Procedure
    End If

    If Me.OpenArgs <> "" Then
        strArgType = Left(Me.OpenArgs, 5)
        If Len(Me.OpenArgs) > 6 Then strOpenArgs = Right(Me.OpenArgs, Len(Me.OpenArgs) - 6)

        Select Case strArgType
          Case "Event"    ' From data gateway - with event
            Me.txtEvent = strOpenArgs
            Me.txtLocation_ID = DLookup("Location_ID", "tbl_Events", _
                "[Event_ID]=""" & strOpenArgs & """")
            fxnLoadForm

          Case "LocID"    ' From data gateway - no event
            Me.txtEvent = Null
            Me.txtLocation_ID = strOpenArgs
            fxnLoadForm

          Case "SitID"    ' Opened from the data entry form
            Me.txtEvent = Null
            Me.txtLocation_ID = Null
            Me.cmbSite = strOpenArgs
            Me.cmbPark = DLookup("Park_code", "tbl_Locations", "[Site_ID] = """ _
                & Me.cmbSite & """")
            Me.txtDate = [Forms]![frm_Data_Entry]![txtDate]
            Me.cmbSite.Locked = True
            ' Enable the new button, but not the new point
            Me.cmdNew.Enabled = True
            Me.cmdNewPoint.Enabled = False

          Case Else
            MsgBox "Unexpected open arguments - please notify the database administrator"
            Me.txtEvent = Null
            Me.txtLocation_ID = Null
            DoCmd.CancelEvent
            GoTo Exit_Procedure
        End Select
    End If

    If IsNull(Me.cmbPark) Then
        ' Set the unbound park code
        If IsNull(TempVars.item("Park")) = False Then
            Me.cmbPark = TempVars.item("Park")
        Else
            Me.cmbPark = "NONE"
        End If
    End If

    ' Set the current user and project code
    If IsNull(TempVars.item("User")) = False Then
        strCurrentUser = TempVars.item("User")
    Else
        strCurrentUser = Environ("Username")
    End If
    If IsNull(TempVars.item("Project")) = False Then
        strProjectCode = TempVars.item("Project")
    Else
        strProjectCode = "NONE"
    End If

    ' Set the datum and declination
    If Me.cmbPark = TempVars.item("Park") Then
        Me.txtDatum = TempVars.item("Datum")
        varDeclination = TempVars.item("Declination")
    Else
        Me.txtDatum = Null
        varDeclination = Null
    End If

    ' Set the focus to the uppermost blank field
    fxnSetFocus

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          cmbPark_KeyDown
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub cmbPark_KeyDown(KeyCode As Integer, Shift As Integer)
    On Error GoTo Err_Handler

    If KeyCode = vbKeyDown Or KeyCode = vbKeyUp Then
    ' Drop down or pull up the combo box list
        KeyCode = 0
        SendKeys "{F4}"
    End If

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          cmbPark_AfterUpdate
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub cmbPark_AfterUpdate()
    On Error GoTo Err_Handler

    Dim strDec As String
    Dim strDatum As String

    ' Move to a new record
    cmdNew_Click

    ' On changing the park, prompt for resetting the datum and declination
    If IsNull(varDeclination) Then strDec = "---" Else: strDec = varDeclination
    If IsNull(Me.txtDatum) Then strDatum = "---" Else: strDatum = Me.txtDatum
    If MsgBox("Please confirm the datum: " & strDatum, vbYesNo, "Confirm park info") _
        = vbNo Then Me.txtDatum = InputBox("Enter the new datum (e.g., NAD83, NAD27, WGS84)")
    If MsgBox("Please confirm the declination: " & strDec, vbYesNo, "Confirm park info") _
        = vbNo Then varDeclination = InputBox("Enter the new declination")

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          cmbSite_GotFocus
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub cmbSite_GotFocus()
    On Error GoTo Err_Handler

    Me.ActiveControl.Requery

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          cmbSite_KeyDown
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub cmbSite_KeyDown(KeyCode As Integer, Shift As Integer)
    On Error GoTo Err_Handler

    If KeyCode = vbKeyDown Or KeyCode = vbKeyUp Then
    ' Drop down or pull up the combo box list
        KeyCode = 0
        SendKeys "{F4}"
    End If

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          cmbSite_NotInList
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub cmbSite_NotInList(NewData As String, Response As Integer)
    On Error GoTo Err_Handler

    Me.ActiveControl.Undo

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          txtDate_GotFocus
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub txtDate_GotFocus()
    On Error GoTo Err_Handler

    Dim vResponse As VbMsgBoxResult
    Dim varDate As Variant
    Dim strSQL As String

    If Me.txtDate.Locked And Not IsNull(Me.txtEvent) Then
        vResponse = MsgBox("Do you want to create a new event? Hit NO to enter a" _
            & vbCrLf & "new date for this event, or CANCEL to do nothing.", _
            vbYesNoCancel + vbDefaultButton2, "Date change options")
        Select Case vResponse

          Case vbYes    ' New event
            varDate = CDate(InputBox("Enter the event date:", "New event date"))
            ' Validate the date entered before proceeding
            If varDate = Me.txtDate Then
                ' Same date entered, so no changes needed
                MsgBox "The same date entered ... no changes were made"
                GoTo Exit_Procedure
            ElseIf IsNull(Me.txtDate) = False Then
                If varDate > Now() Then
                    MsgBox "You cannot enter a date in the future.", _
                        vbCritical, "Validation error"
                    GoTo Exit_Procedure
                ElseIf Now() - varDate > 180 Then
                    If MsgBox("You are trying to enter a date more than 6 months old." & _
                        vbCrLf & "Are you sure this is the correct date?", vbYesNo + vbQuestion, _
                        "Please confirm date") = vbNo Then
                        GoTo Exit_Procedure
                    End If
                End If
            End If
            ' Change the date control
            Me.txtDate = varDate
            Me.cmbObserver = Null
            Me.cmbObserver.Locked = False
            Me.optgVisitType = Null
            Me.optgVisitType.Locked = False
            Me.subEvents.Visible = False
            Me.subEvents.SourceObject = ""
            ' Nullify txtEvent and create a new one ...
            Me.txtEvent = Null
            fxnInsertEvent
            Me.cmbObserver.SetFocus

          Case vbNo     ' Change event date
            varDate = CDate(InputBox("Enter the new date:", "Change event date"))
            ' Validate the date entered before proceeding
            If varDate = Me.txtDate Then
                ' Same date entered, so no changes needed
                MsgBox "The same date entered ... no changes were made"
                GoTo Exit_Procedure
            ElseIf IsNull(Me.txtDate) = False Then
                If varDate > Now() Then
                    MsgBox "You cannot enter a date in the future.", _
                        vbCritical, "Validation error"
                    GoTo Exit_Procedure
                ElseIf Now() - varDate > 180 Then
                    If MsgBox("You are trying to enter a date more than 6 months old." & _
                        vbCrLf & "Are you sure this is the correct date?", vbYesNo + vbQuestion, _
                        "Please confirm date") = vbNo Then
                        GoTo Exit_Procedure
                    End If
                End If
            End If

            ' Check for existing event records with that location-date combination
            If DCount("*", "tbl_Events", "[Location_ID]=""" & Me.txtLocation_ID & _
                """ AND [Start_date]=#" & varDate & "#") > 0 Then
                MsgBox "An event record with the same location and date already exists." & _
                    vbCrLf & vbCrLf & "The date was not changed.", vbOKOnly + vbCritical, _
                    "Unable to change date"
                GoTo Exit_Procedure
            End If

            ' Check for certified record
            Dim varCertDate As Variant
            Dim varUpdateDate As Variant
            varCertDate = DLookup("Certified_date", "tbl_Events", _
                "[Event_ID]=""" & Me.txtEvent & """")
            varUpdateDate = DLookup("Updated_date", "tbl_Events", _
                "[Event_ID]=""" & Me.txtEvent & """")
            If IsNull(varCertDate) = False And (IsNull(varUpdateDate) Or _
                varCertDate >= varUpdateDate) Then
                If Forms!frm_Switchboard!cAppMode = "data entry" Or _
                    IsNull(Forms!frm_Switchboard!cAppMode) Then
                ' For data entry applications, warn the user and disallow edits
                    MsgBox "Changes to certified records are not permitted in data entry mode.", _
                        vbOKOnly + vbCritical, "Cannot update certified records"
                    GoTo Exit_Procedure
                Else
                ' For other application modes, request confirmation before allowing edits
                    If MsgBox("This will change the date for a certified record ..." _
                        & vbCrLf & "Are you certain you want to go ahead with this update?", _
                        vbYesNo + vbExclamation + vbDefaultButton2, "Confirm certified data edit") _
                        = vbNo Then
                        MsgBox "No dates were changed"
                        GoTo Exit_Procedure
                    End If
                    MsgBox "Please log the edits to certified data ..."
                    DoCmd.OpenForm "frm_Edit_Log", , , , , , "Update tbl_Events"
                End If
            End If

            ' Update loc establishment date if same as original date
            If Me.txtLoc_established = Me.txtDate Then
                strSQL = "UPDATE tbl_Locations SET tbl_Locations.Loc_established = #" & varDate & _
                    "#, tbl_Locations.Loc_updated_by = """ & strCurrentUser & _
                    """, tbl_Locations.Loc_updated = Now() WHERE (((tbl_Locations.Location_ID)= """ _
                    & Me.txtLocation_ID & """));"
                DoCmd.SetWarnings False
                DoCmd.RunSQL strSQL
                DoCmd.SetWarnings True
            End If
            ' Change the date control, update query to update the date in the event
            Me.txtDate = varDate
            If IsNull(Me.txtEvent) = False Then
                strSQL = "UPDATE tbl_Events SET tbl_Events.Start_date = #" & varDate & _
                    "#, tbl_Events.Updated_by = """ & strCurrentUser & _
                    """, tbl_Events.Updated_date = Now() WHERE (((tbl_Events.Event_ID)= """ _
                    & Me.txtEvent & """));"
                DoCmd.SetWarnings False
                DoCmd.RunSQL strSQL
                DoCmd.SetWarnings True
            Else: MsgBox "Error:  Me.txtEvent is Null"
            End If

          Case vbCancel
            ' Nothing
        End Select
    End If

Exit_Procedure:
    DoCmd.SetWarnings True
    Exit Sub

Err_Handler:
    Select Case Err.Number
      Case 13
        If MsgBox("Enter a proper date", vbOKCancel, "Type mismatch") = vbCancel Then
            Resume Exit_Procedure
        Else: Resume    ' Keep running the same line asking for a date if user didn't cancel
        End If
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    End Select
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          txtDate_BeforeUpdate
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub txtDate_BeforeUpdate(Cancel As Integer)
    On Error GoTo Err_Handler

    ' Validate the date entered before proceeding
    If IsNull(Me.ActiveControl) = False Then
        If Me.txtDate > Now() Then
            MsgBox "You cannot enter a date in the future.", _
                vbCritical, "Validation error"
            DoCmd.CancelEvent
        ElseIf Now() - Me.txtDate > 180 Then
            If MsgBox("You are trying to enter a date more than 6 months old." & _
                vbCrLf & "Are you sure this is the correct date?", vbYesNo + vbQuestion, _
                "Please confirm date") = vbNo Then DoCmd.CancelEvent
        End If
    End If

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          txtDate_AfterUpdate
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub txtDate_AfterUpdate()
    On Error GoTo Err_Handler
    
    If Not IsNull(Me.cmbSite) And Not IsNull(Me.txtDate) _
        And Not IsNull(Me.txtPoint) Then fxnResetForm

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          cmbObserver_GotFocus
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub cmbObserver_GotFocus()
    On Error GoTo Err_Handler

    If Me.cmbObserver.Locked And Not IsNull(Me.txtEvent) Then
        If MsgBox("Do you want to change the observer for this point description?", _
            vbYesNo + vbDefaultButton2, "Confirm change observer") = vbYes Then
            ' Delete the current observer, nullify and unlock the control
            DoCmd.SetWarnings False
            DoCmd.RunSQL "DELETE tbl_Observers.* FROM tbl_Observers WHERE " & _
                "(((tbl_Observers.Event_ID)=""" & Me.txtEvent & _
                """) AND ((tbl_Observers.Contact_ID)=""" & Me.cmbObserver & _
                """) AND ((tbl_Observers.Observer_role)=""" & Me.txtObserverRole & """));"
            DoCmd.SetWarnings True
            Me.cmbObserver.Locked = False
            Me.cmbObserver = Null
        End If
    End If

Exit_Procedure:
    On Error Resume Next
    DoCmd.SetWarnings True
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          cmbObserver_KeyDown
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub cmbObserver_KeyDown(KeyCode As Integer, Shift As Integer)
    On Error GoTo Err_Handler

    If KeyCode = vbKeyDown Or KeyCode = vbKeyUp Then
    ' Drop down or pull up the combo box list
        KeyCode = 0
        SendKeys "{F4}"
    End If

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          cmbObserver_NotInList
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub cmbObserver_NotInList(NewData As String, Response As Integer)
    On Error GoTo Err_Handler

    Dim ctl As Control

    Set ctl = Me!cmbObserver
    ' Prompt user to confirm they wish to add new value
    If MsgBox("The contact is not in list. Would you like to add this name?", _
        vbYesNo) = vbYes Then
        Response = acDataErrContinue
        ctl.Undo
        Set gvarRefContactCtl = ctl
        DoCmd.OpenForm "frm_Contacts", , , , , , "new"
    Else
    ' Suppress error message and undo changes
        Response = acDataErrContinue
        ctl.Undo
    End If

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          cmbObserver_AfterUpdate
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub cmbObserver_AfterUpdate()
    On Error GoTo Err_Handler

    Dim varReturn As Variant

    If Me.txtPoint.Locked Then Me.optgPointType.SetFocus Else Me.txtPoint.SetFocus
    ' Insert the new observer record if an event is already selected
    If Not IsNull(Me.txtEvent) And Not IsNull(Me.cmbObserver) _
        Then varReturn = fxnInsertObserver(Me.cmbObserver, True)

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          txtPoint_GotFocus
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub txtPoint_GotFocus()
    On Error GoTo Err_Handler

    ' Make sure site/transect and date are entered before allowing entry
    If IsNull(Me.cmbSite) Then
        MsgBox "Enter the transect number first", , "Missing info"
        Me.cmbSite.SetFocus
        GoTo Exit_Procedure
    ElseIf IsNull(Me.txtDate) Then
        MsgBox "Enter the date first", , "Missing info"
        Me.txtDate.SetFocus
        GoTo Exit_Procedure
    End If

    If Me.txtPoint.Locked And Not IsNull(Me.txtLocation_ID) Then

    ' Allow change to location code depending on application mode
    Select Case Forms!frm_Switchboard!cAppMode
      Case "admin", "power user"
        If MsgBox("Are you sure you want to change the code for this point?", vbCritical + _
            vbYesNo + vbDefaultButton2, "Confirm sampling point code change") = vbYes Then
            Me.txtPoint.Locked = False
        End If
      Case "data entry" ' Only allow changes to newly-entered locations
        If DLookup("Location_type", "tbl_Locations", "[Location_ID]=""" & _
            Me.txtLocation_ID & """") = "New" Then
            If MsgBox("Are you sure you want to change the code for this point?", vbCritical + _
                vbYesNo + vbDefaultButton2, "Confirm sampling point code change") = vbYes Then
                Me.txtPoint.Locked = False
            End If
        End If
    End Select

    End If

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          txtPoint_BeforeUpdate
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub txtPoint_BeforeUpdate(Cancel As Integer)
    On Error GoTo Err_Handler

    Dim strSQL As String

    ' Confirm that proper combinations of point code and point type are indicated
    If IsNull(Me.optgPointType) Then
        ' Nothing
    ElseIf Me.txtPoint = "TO" And Me.optgPointType = 1 Then
        If MsgBox("The point code suggests a transect origin.  Are you sure?", vbYesNo, _
            "Validation") = vbNo Then
            DoCmd.CancelEvent
            Me.ActiveControl.Undo
        End If
    ElseIf Me.optgPointType = 0 And Me.txtPoint <> "TO" Then
        If MsgBox("Transect origins should be named 'TO'.  Are you sure?", vbYesNo, _
            "Validation") = vbNo Then
            DoCmd.CancelEvent
            Me.ActiveControl.Undo
        End If
    End If
    
    ' Update the location record if a form location is already selected
    If Not IsNull(Me.txtLocation_ID) Then
        If IsNull(Me.txtPoint) Then
            MsgBox "Enter the point code before proceeding", , "Missing info"
            DoCmd.CancelEvent
            GoTo Exit_Procedure
        Else
            ' Update the location record
            strSQL = "UPDATE tbl_Locations SET tbl_Locations.Location_code = """ & _
                Me.txtPoint & """, tbl_Locations.Loc_updated_by = """ & strCurrentUser & _
                """, tbl_Locations.Loc_updated = Now() WHERE (((tbl_Locations.Location_ID)= """ _
                & Me.txtLocation_ID & """));"
            DoCmd.SetWarnings False
            DoCmd.RunSQL strSQL
        End If
    End If

Exit_Procedure:
    DoCmd.SetWarnings True
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          optgPointType_BeforeUpdate
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub optgPointType_BeforeUpdate(Cancel As Integer)
    On Error GoTo Err_Handler

    ' Confirm that proper combinations of point code and point type are indicated
    If IsNull(Me.txtPoint) Then
        ' Nothing
    ElseIf Me.txtPoint = "TO" And Me.optgPointType = 1 Then
        If MsgBox("The point code suggests a transect origin.  Are you sure?", vbYesNo, _
            "Validation") = vbNo Then
            DoCmd.CancelEvent
            Me.ActiveControl.Undo
        End If
    ElseIf Me.optgPointType = 0 And Me.txtPoint <> "TO" Then
        If MsgBox("Transect origins should be named 'TO'.  Are you sure?", vbYesNo, _
            "Validation") = vbNo Then
            DoCmd.CancelEvent
            Me.ActiveControl.Undo
        End If
    End If

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          optgVisitType_Enter
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub optgVisitType_Enter()
    On Error GoTo Err_Handler

    ' Make sure the required header information is present before proceeding
    '   to allow user to update the control
    If IsNull(Me.cmbSite) Then
        MsgBox "Please indicate the transect", vbOKOnly, "Missing info"
        Me.cmbSite.SetFocus
    ElseIf IsNull(Me.txtDate) Then
        MsgBox "Please enter the date", vbOKOnly, "Missing info"
        Me.txtDate.SetFocus
    ElseIf IsNull(Me.cmbObserver) Then
        MsgBox "Please enter the observer name", vbOKOnly, "Missing info"
        Me.cmbObserver.SetFocus
    ElseIf IsNull(Me.txtPoint) Then
        MsgBox "Please indicate the sampling point code", vbOKOnly, "Missing info"
        Me.txtPoint.SetFocus
    ElseIf IsNull(Me.optgPointType) Then
        MsgBox "Please indicate the sampling point type", vbOKOnly, "Missing info"
        Me.optgPointType.SetFocus
    End If

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          optgVisitType_AfterUpdate
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub optgVisitType_AfterUpdate()
    On Error GoTo Err_Handler

    If Not IsNull(Me.cmbSite) And Not IsNull(Me.txtDate) _
        And Not IsNull(Me.txtPoint) Then fxnResetForm

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          cmdNew_Click
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub cmdNew_Click()
    On Error GoTo Err_Handler

    ' Reset the header controls
    Me.cmbSite = Null
    Me.cmbSite.Locked = False
    Me.txtDate = Null
    Me.txtDate.Locked = False
    Me.cmbObserver = Null
    Me.cmbObserver.Locked = False
    Me.txtPoint = Null
    Me.txtPoint.Locked = False
    Me.optgPointType = Null
    Me.optgPointType.Locked = False
    Me.optgVisitType = Null
    Me.optgVisitType.Locked = False
    ' Nullify the footer read-only fields
    Me.cmbStatus = Null
    Me.txtLoc_established = Null
    Me.txtLoc_discontinued = Null
    ' Disconnect and hide the subform
    Me.subEvents.Visible = False
    Me.subEvents.SourceObject = ""
    ' Nullify the form IDs
    Me.txtLocation_ID = Null
    Me.txtEvent = Null

    Me.cmbSite.SetFocus
    ' Disable the new buttons
    Me.cmdNew.Enabled = False
    Me.cmdNewPoint.Enabled = False

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          cmdNewPoint_Click
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub cmdNewPoint_Click()
    On Error GoTo Err_Handler

    ' Reset the header controls - only the point-specific stuff
    Me.txtPoint = Null
    Me.txtPoint.Locked = False
    Me.optgPointType = Null
    Me.optgPointType.Locked = False
    Me.optgVisitType = Null
    Me.optgVisitType.Locked = False
    ' Nullify the footer read-only fields
    Me.cmbStatus = Null
    Me.txtLoc_established = Null
    Me.txtLoc_discontinued = Null
    ' Disconnect and hide the subform
    Me.subEvents.Visible = False
    Me.subEvents.SourceObject = ""
    ' Nullify the form IDs
    Me.txtLocation_ID = Null
    Me.txtEvent = Null

    If Not IsNull(Me.txtDate) Or Not IsNull(Me.cmbObserver) Then
        If MsgBox("Keep the same date & observer?", vbYesNo) = vbNo Then
            Me.txtDate = Null
            Me.txtDate.Locked = False
            Me.cmbObserver = Null
            Me.cmbObserver.Locked = False
            Me.txtDate.SetFocus
        Else
            fxnSetFocus
        End If
    Else
        fxnSetFocus
    End If
    ' Disable the new point button
    Me.cmdNewPoint.Enabled = False

Exit_Procedure:
    Exit Sub

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    Resume Exit_Procedure

End Sub

' ---------------------------------
' SUB:          cmdClose_Click
' Description:
' Parameters:   -
' Returns:      -
' Throws:       -
' References:   -
' Source/date:  John R. Boetsch, May 2008
' Adapted:      Bonnie Campbell, June, 2014 for NCPN WQ Utilities tool
' Revisions:    BLC, 7/29/2014 - XX
' ---------------------------------
Private Sub cmdClose_Click()
    On Error GoTo Err_Handler

    Dim rst As DAO.Recordset
    Dim strCondition As String

    ' If the form was just opened or has no subform/event, close without bookmarking
    If Me.subEvents.SourceObject = "" Then
        DoCmd.Close , , acSaveNo
        GoTo Exit_Procedure
    ElseIf IsNull(Me.subEvents.Form!Event_ID) Then
        DoCmd.Close , , acSaveNo
        GoTo Exit_Procedure
    Else
        ' Set the string for moving to the current record in the referring form
        strCondition = "[Location_ID]=""" & Me.subEvents.Form!Location_ID & _
            """ AND [Event_ID]=""" & Me.subEvents.Form!Event_ID & """"

        DoCmd.Close , , acSaveNo
        gvarRefForm.Requery
        gvarRefCtl.Requery

        If gvarRefForm.name = "frm_Data_Gateway" Then
            ' Bookmark the record on the referring form
            Set rst = gvarRefForm.RecordsetClone
            rst.FindFirst strCondition
            If rst.NoMatch Then
                ' MsgBox "No entry found.", vbInformation
            Else
                gvarRefForm.Bookmark = rst.Bookmark
            End If
        End If
    End If

Exit_Procedure:
    On Error Resume Next
    Set rst = Nothing
    Exit Sub

Err_Handler:
    Select Case Err.Number
      Case 2001   ' Run time canceled event (validation error) - exit without closing
      Case 91     ' Do nothing - object variable not set
      Case 2467   ' Do nothing - object does not exist
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical
    End Select
    Resume Exit_Procedure

End Sub

' =================================
' FUNCTION:     fxnSetFocus
' Description:  Sets the current focus to the uppermost blank control
' Parameters:   none
' Returns:      none
' Throws:       none
' References:   none
' Source/date:  John R. Boetsch, July 2006
' Revisions:    <name, date, desc - add lines as you go>
' =================================

Private Function fxnSetFocus()
    On Error GoTo Err_Handler

    ' Set the focus to the uppermost blank field
    If IsNull(Me.cmbPark) Then
        Me.cmbPark.SetFocus
    ElseIf IsNull(Me.cmbSite) Then
        Me.cmbSite.SetFocus
    ElseIf IsNull(Me.txtDate) Then
        Me.txtDate.SetFocus
    ElseIf IsNull(Me.cmbObserver) Then
        Me.cmbObserver.SetFocus
    ElseIf IsNull(Me.txtPoint) Then
        Me.txtPoint.SetFocus
    Else
        If Me.subEvents.Visible Then Me.subEvents.SetFocus Else Me.optgPointType.SetFocus
        ' Me.subEvents.Form!pg1.SetFocus
    End If

Exit_Procedure:
    Exit Function

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
        "Error encountered (#" & Err.Number & " - fxnSetFocus)"
    Resume Exit_Procedure

End Function

' =================================
' FUNCTION:     fxnInsertEvent
' Description:  Inserts a new record into the events table
' Parameters:   none
' Returns:      none
' Throws:       none
' References:   fxnGUIDGen
' Source/date:  John R. Boetsch, July 2006
' Revisions:    JRB, 7/19/2011 - added strDeclination to handle null/empty strings, and
'                   changed RunSQL to Execute in order to have rollback and notification
' =================================

Private Function fxnInsertEvent()
    On Error GoTo Err_Handler

    Dim ws As DAO.Workspace
    Dim db As DAO.Database
    Dim blnInTrans As Boolean
    Dim strSQL As String
    Dim strDeclination As String

    ' Empty string not acceptable in declination, convert to null
    If varDeclination = "" Or IsNull(varDeclination) Or IsEmpty(varDeclination) Then
        strDeclination = "Null"
    Else: strDeclination = varDeclination
    End If

    ' Create the event primary key value
    Me.txtEvent = fxnGUIDGen
    ' Insert the event record
    strSQL = "INSERT INTO tbl_Events ( Event_ID, Location_ID, " & _
        "Start_date, Project_code, Declination, Entered_by ) SELECT """ _
        & Me.txtEvent & """ AS Event_ID, """ _
        & Me.txtLocation_ID & """ AS Location_ID, #" _
        & Me.txtDate & "# AS Start_date, """ _
        & strProjectCode & """ AS Project_code, """ _
        & strDeclination & """ AS Declination, """ _
        & strCurrentUser & """ AS Entered_by;"

    ' Run the SQL statement with rollback and error notification
    Set ws = DBEngine(0)
    Set db = CurrentDb
    ws.BeginTrans
    blnInTrans = True
    db.Execute strSQL, dbFailOnError
    ws.CommitTrans
    blnInTrans = False

Exit_Procedure:
    On Error Resume Next
    Set db = Nothing
    If blnInTrans Then ws.Rollback
    Set ws = Nothing
    Exit Function

Err_Handler:
    Select Case Err.Number
      Case 3200, 3201 ' Referential integrity violated
        MsgBox "Error #" & Err.Number & ": " & Err.Description & vbCrLf & _
            "Unable to insert a new event record.", vbCritical, _
            "Error encountered (#" & Err.Number & " - fxnInsertEvent)"
      Case 3144 ' Syntax error in SQL statement
        MsgBox "Error #" & Err.Number & ": " & Err.Description & vbCrLf & _
            "Unable to insert a new event record.", vbCritical, _
            "Error encountered (#" & Err.Number & " - fxnInsertEvent)"
      Case 3464 ' Data type mismatch
        MsgBox "Error #" & Err.Number & ": " & Err.Description & vbCrLf & _
            "Unable to insert a new event record.", vbCritical, _
            "Error encountered (#" & Err.Number & " - fxnInsertEvent)"
      Case 3061 ' Misnamed column
        MsgBox "Error #" & Err.Number & ": " & Err.Description & vbCrLf & _
            "Unable to insert a new event record.", vbCritical, _
            "Error encountered (#" & Err.Number & " - fxnInsertEvent)"
      Case 3022 ' Duplicate records in index
        MsgBox "Error #" & Err.Number & ": " & Err.Description & vbCrLf & _
            "Unable to insert a new event record.", vbCritical, _
            "Error encountered (#" & Err.Number & " - fxnInsertEvent)"
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - fxnInsertEvent)"
    End Select
    Resume Exit_Procedure

End Function

' =================================
' FUNCTION:     fxnInsertObserver
' Description:  Inserts the specified observer into the observer table
' Parameters:   strObserver - the observer ID to be inserted
'               bUpdateEvent - true/false on whether to update the event as well
' Returns:      none
' Throws:       none
' References:   none
' Source/date:  John R. Boetsch, July 2006
' Revisions:    <name, date, desc - add lines as you go>
' =================================

Private Function fxnInsertObserver(ByVal strObserver As String, _
    Optional ByVal bUpdateEvent As Boolean = False)

    On Error GoTo Err_Handler

    Dim strSQL As String

    ' Insert the observer record
    strSQL = "INSERT INTO tbl_Observers ( Event_ID, Contact_ID, Observer_role ) SELECT """ _
        & Me.txtEvent & """ AS Event_ID, """ & strObserver & """ AS Contact_ID, """ _
        & Me.txtObserverRole & """ AS Observer_role;"
    DoCmd.SetWarnings False
    DoCmd.RunSQL strSQL
    DoCmd.SetWarnings True

    If bUpdateEvent Then
        ' Update the event record tracking info
        strSQL = "UPDATE tbl_Events SET tbl_Events.Updated_by = """ & strCurrentUser & _
            """, tbl_Events.Updated_date = Now() WHERE (((tbl_Events.Event_ID)=""" & Me.txtEvent & """));"
        DoCmd.SetWarnings False
        DoCmd.RunSQL strSQL
    End If

Exit_Procedure:
    DoCmd.SetWarnings True
    Exit Function

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
        "Error encountered (#" & Err.Number & " - fxnInsertObserver)"
    Resume Exit_Procedure

End Function

' =================================
' FUNCTION:     fxnResetForm
' Description:  Moves to the record(s) indicated by the site, date and point ctls if one exists, or
'                   creates new record(s) if not; assumes that site, date and point code are populated
' Parameters:   none
' Returns:      none
' Throws:       none
' References:   fxnSetFocus, fxnLoadForm, fxnInsertEvent, fxnInsertObserver, fxnGUIDGen
' Source/date:  John R. Boetsch, July 2006
' Revisions:    <name, date, desc - add lines as you go>
' =================================

Private Function fxnResetForm()
    On Error GoTo Err_Handler

    Dim strCondition As String
    Dim varLoc As Variant
    Dim varEvent As Variant
    Dim rst As DAO.Recordset
    Dim strRstString As String

    If IsNull(Me.txtLocation_ID) Then

        strCondition = "[Location_code] = """ & Me.txtPoint & _
            """ AND [Site_ID] = """ & Me.cmbSite & """"
    
        varLoc = DLookup("[Location_ID]", "tbl_Locations", strCondition)

        If Not IsNull(varLoc) Then
            ' Location exists
            Me.txtLocation_ID = varLoc
            varEvent = DLookup("[Event_ID]", "tbl_Events", "[Start_date]=#" & Me.txtDate & _
                "# AND [Location_ID]=""" & varLoc & """")
            If Not IsNull(varEvent) Then
                ' Event exists - load location and event info
                Me.txtEvent = varEvent
                fxnLoadForm
                GoTo Set_Focus_Routine
            Else
                ' Load the location info, insert the event, insert the observer (if present)
                fxnLoadForm
                fxnInsertEvent
                If Not IsNull(Me.cmbObserver) Then fxnInsertObserver (Me.cmbObserver)
                ' Lock the date control and observer control if it is not null
                '  Note: these controls not reset by fxnLoadForm because Event was missing when run
                Me.txtDate.Locked = True
                Me.cmbObserver.Locked = Not IsNull(Me.cmbObserver)
                ' Connect and enable the subform
                Me.subEvents.SourceObject = "fsub_Point_Est_Event"
                Me.subEvents.Visible = True
                GoTo Set_Focus_Routine
            End If

        Else
            ' Insert the new location record
            Me.txtLocation_ID = fxnGUIDGen
            strRstString = "SELECT tbl_Locations.Location_ID, tbl_Locations.Park_code, " & _
                "tbl_Locations.Site_ID, tbl_Locations.Location_code, " & _
                "tbl_Locations.Location_type, tbl_Locations.Location_status, " & _
                "tbl_Locations.Loc_established, " & _
                "tbl_Locations.Loc_updated_by FROM tbl_Locations " & _
                "WHERE (((tbl_Locations.Location_ID) = """ & Me.txtLocation_ID & """));"

            Set rst = CurrentDb.OpenRecordset(strRstString)

            BeginTrans
            rst.AddNew ' Clears copy buffer to prepare for new record
            rst!Location_ID = Me.txtLocation_ID
            rst!Park_code = Me.cmbPark
            rst!Site_ID = Me.cmbSite
            rst!Location_code = Me.txtPoint
            If Me.optgPointType = 0 Then rst!Location_type = "Origin" _
                Else rst!Location_type = "New"
            rst!Location_status = "Active"
            rst!Loc_established = Me.txtDate
            rst!Loc_updated_by = strCurrentUser
            rst.Update
            CommitTrans ' All or nothing, simultaneous transactions rather than piecemeal

            ' Finish up within the shared routine
            GoTo Has_Loc_New_Event

        End If
    Else
        ' If there is a location but no event, move to the shared routine
        GoTo Has_Loc_New_Event
    End If

Has_Loc_New_Event:
    ' Create a new event record, and insert the observer (if present)
    If IsNull(Me.txtEvent) Then fxnInsertEvent
    If Not IsNull(Me.cmbObserver) Then fxnInsertObserver (Me.cmbObserver)

    ' Connect and enable the subform
    Me.subEvents.SourceObject = "fsub_Point_Est_Event"
    Me.subEvents.Visible = True

    ' Lock the controls that are not null
    Me.cmbSite.Locked = True
    Me.txtDate.Locked = True
    Me.txtPoint.Locked = True
    Me.cmbObserver.Locked = Not IsNull(Me.cmbObserver)
    Me.optgPointType.Locked = Not IsNull(Me.optgPointType)

    ' Enable the new buttons
    Me.cmdNew.Enabled = True
    Me.cmdNewPoint.Enabled = True

Set_Focus_Routine:
    Me.optgVisitType.Locked = Not IsNull(Me.optgVisitType)
    ' Set the focus to the uppermost blank field
    fxnSetFocus

Exit_Procedure:
    On Error Resume Next
    rst.Close
    Set rst = Nothing
    Exit Function

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
        "Error encountered (#" & Err.Number & " - fxnResetForm)"
    Resume Exit_Procedure

End Function

' =================================
' FUNCTION:     fxnLoadForm
' Description:  Loads location info - and if present, event and observer info - into the unbound ctls
' Parameters:   none
' Returns:      none
' Throws:       none
' References:   fxnInsertObserver
' Source/date:  John R. Boetsch, July 2006
' Revisions:    <name, date, desc - add lines as you go>
' =================================

Private Function fxnLoadForm()
    On Error GoTo Err_Handler

    Dim rst As DAO.Recordset
    Dim strRstString As String
    Dim intNRecs As Integer
    Dim varObserver As Variant
    Dim varReturn As Variant

    If Not IsNull(Me.txtLocation_ID) Then

        strRstString = "SELECT tbl_Locations.Park_code, tbl_Locations.Site_ID, " & _
            "tbl_Locations.Location_code, tbl_Locations.Location_type, " & _
            "tbl_Locations.Location_status, tbl_Locations.Loc_established, " & _
            "tbl_Locations.Loc_discontinued FROM tbl_Locations " & _
            "WHERE (((tbl_Locations.Location_ID) = """ & Me.txtLocation_ID & """));"

        Set rst = CurrentDb.OpenRecordset(strRstString)

        ' Counts the number of linked tables in the recordset - move last makes count accurate
        rst.MoveLast
        intNRecs = rst.RecordCount
        ' Bail out if no records
        If intNRecs = 0 Then
            MsgBox "No records returned in recordset - notify the database administrator"
            GoTo Exit_Procedure
        End If

        rst.MoveFirst
        Me.cmbPark = rst!Park_code
        Me.cmbSite = rst!Site_ID
        Me.txtPoint = rst!Location_code
        If rst!Location_type = "Survey" Or rst!Location_type = "Additional" Then
            Me.optgPointType = 1
        ElseIf rst!Location_type = "New" Then
            Me.optgPointType = 1
        ElseIf rst!Location_type = "Origin" Then
            Me.optgPointType = 0
        Else
            Me.optgPointType = Null
            MsgBox "Warning: unexpected point type ...", vbOKOnly + vbExclamation
        End If
        Me.cmbStatus = rst!Location_status
        Me.txtLoc_established = rst!Loc_established
        Me.txtLoc_discontinued = rst!Loc_discontinued
        ' Lock the appropriate header controls
        Me.cmbSite.Locked = True
        Me.txtPoint.Locked = True
        Me.optgPointType.Locked = True

        If Not IsNull(Me.txtEvent) Then
            ' Load the event date and observer into the unbound controls and lock them
            Me.txtDate = DLookup("Start_date", "tbl_Events", "[Event_ID] = """ & Me.txtEvent & """")
            Me.txtDate.Locked = True
            varObserver = DLookup("Contact_ID", "tbl_Observers", "[Event_ID] = """ & _
                Me.txtEvent & """ AND [Observer_role] = """ & Me.txtObserverRole & """")
            If IsNull(Me.cmbObserver) And Not IsNull(varObserver) Then
                Me.cmbObserver = varObserver
            ElseIf Not IsNull(Me.cmbObserver) And Not IsNull(varObserver) And _
                Me.cmbObserver <> varObserver Then
                ' The observer for the current record is different than what is in the control
                MsgBox "The stored observer for this event" & vbCrLf & _
                    "is different from the one you specify", vbOKOnly + vbExclamation
                Me.cmbObserver = varObserver
            ElseIf IsNull(varObserver) And IsNull(Me.cmbObserver) = False Then
                ' No observer in the record, but one in the control
                If MsgBox("Would you like to add " & Me.cmbObserver & " as the observer for this event?", _
                    vbYesNo, "Add observer to this record") = vbYes Then
                    ' Insert the new observer
                    varReturn = fxnInsertObserver(Me.cmbObserver, True)
                Else
                    Me.cmbObserver = Null
                End If
            End If
            ' Unlock the observer control if it is null
            Me.cmbObserver.Locked = Not IsNull(Me.cmbObserver)
            ' Connect and enable the subform
            Me.subEvents.SourceObject = "fsub_Point_Est_Event"
            Me.subEvents.Visible = True
        End If
        ' Enable the new buttons
        Me.cmdNew.Enabled = True
        Me.cmdNewPoint.Enabled = True
    End If

Exit_Procedure:
    On Error Resume Next
    rst.Close
    Set rst = Nothing
    Exit Function

Err_Handler:
    MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
        "Error encountered (#" & Err.Number & " - fxnLoadForm)"
    Resume Exit_Procedure

End Function